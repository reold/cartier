var Et=Object.defineProperty;var Pt=(t,e,n)=>e in t?Et(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var De=(t,e,n)=>(Pt(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&l(s)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function l(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();function D(){}const We=t=>t;function Fe(t,e){for(const n in e)t[n]=e[n];return t}function vt(t){return t()}function Ye(){return Object.create(null)}function G(t){t.forEach(vt)}function Pe(t){return typeof t=="function"}function J(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let qe;function we(t,e){return t===e?!0:(qe||(qe=document.createElement("a")),qe.href=e,t===qe.href)}function Dt(t){return Object.keys(t).length===0}function _t(t,...e){if(t==null){for(const l of e)l(void 0);return D}const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function I(t){let e;return _t(t,n=>e=n)(),e}function W(t,e,n){t.$$.on_destroy.push(_t(e,n))}function yt(t,e,n,l){if(t){const r=kt(t,e,n,l);return t[0](r)}}function kt(t,e,n,l){return t[1]&&l?Fe(n.ctx.slice(),t[1](l(e))):n.ctx}function $t(t,e,n,l){if(t[2]&&l){const r=t[2](l(n));if(e.dirty===void 0)return r;if(typeof r=="object"){const i=[],s=Math.max(e.dirty.length,r.length);for(let o=0;o<s;o+=1)i[o]=e.dirty[o]|r[o];return i}return e.dirty|r}return e.dirty}function xt(t,e,n,l,r,i){if(r){const s=kt(e,n,l,i);t.p(s,r)}}function Lt(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let l=0;l<n;l++)e[l]=-1;return e}return-1}function T(t,e,n){return t.set(n),e}function Ht(t){const e=typeof t=="string"&&t.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[t,"px"]}const Mt=typeof window<"u";let ze=Mt?()=>window.performance.now():()=>Date.now(),Ve=Mt?t=>requestAnimationFrame(t):D;const me=new Set;function St(t){me.forEach(e=>{e.c(t)||(me.delete(e),e.f())}),me.size!==0&&Ve(St)}function Re(t){let e;return me.size===0&&Ve(St),{promise:new Promise(n=>{me.add(e={c:t,f:n})}),abort(){me.delete(e)}}}function p(t,e){t.appendChild(e)}function Ct(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function Ft(t){const e=w("style");return e.textContent="/* empty */",Nt(Ct(t),e),e.sheet}function Nt(t,e){return p(t.head||t,e),e.sheet}function A(t,e,n){t.insertBefore(e,n||null)}function C(t){t.parentNode&&t.parentNode.removeChild(t)}function Ce(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function w(t){return document.createElement(t)}function Y(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function F(t){return document.createTextNode(t)}function O(){return F(" ")}function ve(){return F("")}function H(t,e,n,l){return t.addEventListener(e,n,l),()=>t.removeEventListener(e,n,l)}function u(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Zt(t){return Array.from(t.childNodes)}function Q(t,e){e=""+e,t.data!==e&&(t.data=e)}function Ge(t,e){t.value=e??""}function $e(t,e,n,l){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,l?"important":"")}function Je(t,e,n){t.classList.toggle(e,!!n)}function It(t,e,{bubbles:n=!1,cancelable:l=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:l})}const Oe=new Map;let Te=0;function Bt(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}function Ut(t,e){const n={stylesheet:Ft(e),rules:{}};return Oe.set(t,n),n}function Ne(t,e,n,l,r,i,s,o=0){const a=16.666/l;let c=`{
`;for(let v=0;v<=1;v+=a){const b=e+(n-e)*i(v);c+=v*100+`%{${s(b,1-b)}}
`}const f=c+`100% {${s(n,1-n)}}
}`,d=`__svelte_${Bt(f)}_${o}`,g=Ct(t),{stylesheet:h,rules:m}=Oe.get(g)||Ut(g,t);m[d]||(m[d]=!0,h.insertRule(`@keyframes ${d} ${f}`,h.cssRules.length));const y=t.style.animation||"";return t.style.animation=`${y?`${y}, `:""}${d} ${l}ms linear ${r}ms 1 both`,Te+=1,d}function Ze(t,e){const n=(t.style.animation||"").split(", "),l=n.filter(e?i=>i.indexOf(e)<0:i=>i.indexOf("__svelte")===-1),r=n.length-l.length;r&&(t.style.animation=l.join(", "),Te-=r,Te||Wt())}function Wt(){Ve(()=>{Te||(Oe.forEach(t=>{const{ownerNode:e}=t.stylesheet;e&&C(e)}),Oe.clear())})}let xe;function ye(t){xe=t}function zt(){if(!xe)throw new Error("Function called outside component initialization");return xe}function Le(t){zt().$$.on_mount.push(t)}const ge=[],Me=[];let he=[];const Qe=[],Vt=Promise.resolve();let Ie=!1;function Rt(){Ie||(Ie=!0,Vt.then(qt))}function se(t){he.push(t)}const He=new Set;let fe=0;function qt(){if(fe!==0)return;const t=xe;do{try{for(;fe<ge.length;){const e=ge[fe];fe++,ye(e),Yt(e.$$)}}catch(e){throw ge.length=0,fe=0,e}for(ye(null),ge.length=0,fe=0;Me.length;)Me.pop()();for(let e=0;e<he.length;e+=1){const n=he[e];He.has(n)||(He.add(n),n())}he.length=0}while(ge.length);for(;Qe.length;)Qe.pop()();Ie=!1,He.clear(),ye(t)}function Yt(t){if(t.fragment!==null){t.update(),G(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(se)}}function Gt(t){const e=[],n=[];he.forEach(l=>t.indexOf(l)===-1?e.push(l):n.push(l)),n.forEach(l=>l()),he=e}let _e;function jt(){return _e||(_e=Promise.resolve(),_e.then(()=>{_e=null})),_e}function ke(t,e,n){t.dispatchEvent(It(`${e?"intro":"outro"}${n}`))}const je=new Set;let ie;function ae(){ie={r:0,c:[],p:ie}}function ce(){ie.r||G(ie.c),ie=ie.p}function E(t,e){t&&t.i&&(je.delete(t),t.i(e))}function P(t,e,n,l){if(t&&t.o){if(je.has(t))return;je.add(t),ie.c.push(()=>{je.delete(t),l&&(n&&t.d(1),l())}),t.o(e)}else l&&l()}const At={duration:0};function Jt(t,e,n){const l={direction:"in"};let r=e(t,n,l),i=!1,s,o,a=0;function c(){s&&Ze(t,s)}function f(){const{delay:g=0,duration:h=300,easing:m=We,tick:y=D,css:v}=r||At;v&&(s=Ne(t,0,1,h,g,m,v,a++)),y(0,1);const b=ze()+g,q=b+h;o&&o.abort(),i=!0,se(()=>ke(t,!0,"start")),o=Re(k=>{if(i){if(k>=q)return y(1,0),ke(t,!0,"end"),c(),i=!1;if(k>=b){const L=m((k-b)/h);y(L,1-L)}}return i})}let d=!1;return{start(){d||(d=!0,Ze(t),Pe(r)?(r=r(l),jt().then(f)):f())},invalidate(){d=!1},end(){i&&(c(),i=!1)}}}function be(t,e,n,l){let i=e(t,n,{direction:"both"}),s=l?0:1,o=null,a=null,c=null,f;function d(){c&&Ze(t,c)}function g(m,y){const v=m.b-s;return y*=Math.abs(v),{a:s,b:m.b,d:v,duration:y,start:m.start,end:m.start+y,group:m.group}}function h(m){const{delay:y=0,duration:v=300,easing:b=We,tick:q=D,css:k}=i||At,L={start:ze()+y,b:m};m||(L.group=ie,ie.r+=1),"inert"in t&&(m?f!==void 0&&(t.inert=f):(f=t.inert,t.inert=!0)),o||a?a=L:(k&&(d(),c=Ne(t,s,m,v,y,b,k)),m&&q(0,1),o=g(L,v),se(()=>ke(t,m,"start")),Re(_=>{if(a&&_>a.start&&(o=g(a,v),a=null,ke(t,o.b,"start"),k&&(d(),c=Ne(t,s,o.b,o.duration,0,b,i.css))),o){if(_>=o.end)q(s=o.b,1-s),ke(t,o.b,"end"),a||(o.b?d():--o.group.r||G(o.group.c)),o=null;else if(_>=o.start){const M=_-o.start;s=o.a+o.d*b(M/o.duration),q(s,1-s)}}return!!(o||a)}))}return{run(m){Pe(i)?jt().then(()=>{i=i({direction:m?"in":"out"}),h(m)}):h(m)},end(){d(),o=a=null}}}function le(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function ne(t){t&&t.c()}function X(t,e,n){const{fragment:l,after_update:r}=t.$$;l&&l.m(e,n),se(()=>{const i=t.$$.on_mount.map(vt).filter(Pe);t.$$.on_destroy?t.$$.on_destroy.push(...i):G(i),t.$$.on_mount=[]}),r.forEach(se)}function K(t,e){const n=t.$$;n.fragment!==null&&(Gt(n.after_update),G(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Qt(t,e){t.$$.dirty[0]===-1&&(ge.push(t),Rt(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ee(t,e,n,l,r,i,s=null,o=[-1]){const a=xe;ye(t);const c=t.$$={fragment:null,ctx:[],props:i,update:D,not_equal:r,bound:Ye(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:Ye(),dirty:o,skip_bound:!1,root:e.target||a.$$.root};s&&s(c.root);let f=!1;if(c.ctx=n?n(t,e.props||{},(d,g,...h)=>{const m=h.length?h[0]:g;return c.ctx&&r(c.ctx[d],c.ctx[d]=m)&&(!c.skip_bound&&c.bound[d]&&c.bound[d](m),f&&Qt(t,d)),g}):[],c.update(),f=!0,G(c.before_update),c.fragment=l?l(c.ctx):!1,e.target){if(e.hydrate){const d=Zt(e.target);c.fragment&&c.fragment.l(d),d.forEach(C)}else c.fragment&&c.fragment.c();e.intro&&E(t.$$.fragment),X(t,e.target,e.anchor),qt()}ye(a)}class te{constructor(){De(this,"$$");De(this,"$$set")}$destroy(){K(this,1),this.$destroy=D}$on(e,n){if(!Pe(n))return D;const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(n),()=>{const r=l.indexOf(n);r!==-1&&l.splice(r,1)}}$set(e){this.$$set&&!Dt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Xt="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Xt);window["cartier-server-url"]="https://cartier-beta.glitch.me";const re={getRoot:async()=>await(await fetch(`${window["cartier-server-url"]}/`)).json(),getUserInfo:async t=>await(await fetch(`${window["cartier-server-url"]}/api/user?userid=${t}`)).json(),getPlaylistInfo:async t=>await(await fetch(`${window["cartier-server-url"]}/api/playlist?id=${t}`)).json(),getDownloadPlaylist:async t=>await(await fetch(`${window["cartier-server-url"]}/api/download?link=${t}`)).json(),getDownloadStatus:async t=>await(await fetch(`${window["cartier-server-url"]}/api/status?key=${t}`)).json(),getDownloadTrack:async(t,e="",n=!1)=>await(await fetch(`${window["cartier-server-url"]}/api/track?link=${t}&key=${e}&create=${n}`)).json(),getStreamPlaylist:async t=>{let e=await fetch(`${window["cartier-server-url"]}/api/stream?key=${t}`);return[await e.ok,await e.blob(),e.headers.get("x-trackid")]}},pe=[];function ue(t,e=D){let n;const l=new Set;function r(o){if(J(t,o)&&(t=o,n)){const a=!pe.length;for(const c of l)c[1](),pe.push(c,t);if(a){for(let c=0;c<pe.length;c+=2)pe[c][0](pe[c+1]);pe.length=0}}}function i(o){r(o(t))}function s(o,a=D){const c=[o,a];return l.add(c),l.size===1&&(n=e(r,i)||D),o(t),()=>{l.delete(c),l.size===0&&n&&(n(),n=null)}}return{set:r,update:i,subscribe:s}}function Xe(t){return 1-Math.sqrt(1-t*t)}function Ot(t){return t<.5?4*t*t*t:.5*Math.pow(2*t-2,3)+1}function Kt(t){const e=t-1;return e*e*e+1}function Ke(t,{delay:e=0,duration:n=400,easing:l=Ot,amount:r=5,opacity:i=0}={}){const s=getComputedStyle(t),o=+s.opacity,a=s.filter==="none"?"":s.filter,c=o*(1-i),[f,d]=Ht(r);return{delay:e,duration:n,easing:l,css:(g,h)=>`opacity: ${o-c*h}; filter: ${a} blur(${h*f}${d});`}}function Se(t,{delay:e=0,duration:n=400,easing:l=Kt,axis:r="y"}={}){const i=getComputedStyle(t),s=+i.opacity,o=r==="y"?"height":"width",a=parseFloat(i[o]),c=r==="y"?["top","bottom"]:["left","right"],f=c.map(b=>`${b[0].toUpperCase()}${b.slice(1)}`),d=parseFloat(i[`padding${f[0]}`]),g=parseFloat(i[`padding${f[1]}`]),h=parseFloat(i[`margin${f[0]}`]),m=parseFloat(i[`margin${f[1]}`]),y=parseFloat(i[`border${f[0]}Width`]),v=parseFloat(i[`border${f[1]}Width`]);return{delay:e,duration:n,easing:l,css:b=>`overflow: hidden;opacity: ${Math.min(b*20,1)*s};${o}: ${b*a}px;padding-${c[0]}: ${b*d}px;padding-${c[1]}: ${b*g}px;margin-${c[0]}: ${b*h}px;margin-${c[1]}: ${b*m}px;border-${c[0]}-width: ${b*y}px;border-${c[1]}-width: ${b*v}px;`}}function et(t){let e,n,l,r;const i=t[2].default,s=yt(i,t,t[1],null);return{c(){e=w("div"),n=w("div"),s&&s.c(),u(n,"class","bg-foreground p-2 rounded-md ring-1 ring-border max-w-[90vw] flex flex-col"),u(e,"class","absolute top-0 left-0 w-full h-full backdrop-blur-md flex flex-col items-center justify-center text-center text-xs")},m(o,a){A(o,e,a),p(e,n),s&&s.m(n,null),r=!0},p(o,a){s&&s.p&&(!r||a&2)&&xt(s,i,o,o[1],r?$t(i,o[1],a,null):Lt(o[1]),null)},i(o){r||(E(s,o),o&&se(()=>{r&&(l||(l=be(e,Ke,{duration:500},!0)),l.run(1))}),r=!0)},o(o){P(s,o),o&&(l||(l=be(e,Ke,{duration:500},!1)),l.run(0)),r=!1},d(o){o&&C(e),s&&s.d(o),o&&l&&l.end()}}}function el(t){let e,n,l=!t[0]&&et(t);return{c(){l&&l.c(),e=ve()},m(r,i){l&&l.m(r,i),A(r,e,i),n=!0},p(r,[i]){r[0]?l&&(ae(),P(l,1,1,()=>{l=null}),ce()):l?(l.p(r,i),i&1&&E(l,1)):(l=et(r),l.c(),E(l,1),l.m(e.parentNode,e))},i(r){n||(E(l),n=!0)},o(r){P(l),n=!1},d(r){r&&C(e),l&&l.d(r)}}}function tl(t,e,n){let{$$slots:l={},$$scope:r}=e,{hidden:i=!1}=e;return t.$$set=s=>{"hidden"in s&&n(0,i=s.hidden),"$$scope"in s&&n(1,r=s.$$scope)},[i,r,l]}class ll extends te{constructor(e){super(),ee(this,e,tl,el,J,{hidden:0})}}function tt(t){let e,n;return{c(){e=Y("svg"),n=Y("path"),u(n,"stroke-linecap","round"),u(n,"stroke-linejoin","round"),u(n,"d","M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"fill","none"),u(e,"viewBox","0 0 24 24"),u(e,"stroke-width","1.5"),u(e,"stroke","currentColor"),u(e,"class","aspect-square w-[1.2em] animate-spin inline")},m(l,r){A(l,e,r),p(e,n)},d(l){l&&C(e)}}}function nl(t){let e,n,l,r,i,s,o=t[0].step+"",a,c=t[0].is&&tt();return{c(){e=w("h1"),e.textContent="Starting Up Servers!",n=O(),l=w("p"),l.textContent=`Our servers take a little break every few minutes when things quiet down.
    We're in the process of waking them up for you. It's automatic, so no need
    to stress!`,r=O(),i=w("p"),c&&c.c(),s=O(),a=F(o),u(e,"class","text-2xl"),u(l,"class","text-xs text-white/70 inline"),u(i,"class","inline"),Je(i,"text-green-500",!t[0].is)},m(f,d){A(f,e,d),A(f,n,d),A(f,l,d),A(f,r,d),A(f,i,d),c&&c.m(i,null),p(i,s),p(i,a)},p(f,d){f[0].is?c||(c=tt(),c.c(),c.m(i,s)):c&&(c.d(1),c=null),d&1&&o!==(o=f[0].step+"")&&Q(a,o),d&1&&Je(i,"text-green-500",!f[0].is)},d(f){f&&(C(e),C(n),C(l),C(r),C(i)),c&&c.d()}}}function rl(t){let e,n;return e=new ll({props:{hidden:!t[0].is,$$slots:{default:[nl]},$$scope:{ctx:t}}}),{c(){ne(e.$$.fragment)},m(l,r){X(e,l,r),n=!0},p(l,[r]){const i={};r&1&&(i.hidden=!l[0].is),r&9&&(i.$$scope={dirty:r,ctx:l}),e.$set(i)},i(l){n||(E(e.$$.fragment,l),n=!0)},o(l){P(e.$$.fragment,l),n=!1},d(l){K(e,l)}}}function il(t,e,n){let l;const r=ue({step:"trying to make contact",is:!0});W(t,r,s=>n(0,l=s));let{handleWakeup:i}=e;return Le(()=>{T(r,l.step="waking up servers",l),re.getRoot().then(s=>{T(r,l.is=!1,l),T(r,l.step="servers are running!",l),i(!0)}).catch(s=>{N(`servers are unreachable (${s})`),T(r,l.step="servers are unreachable (reload?)",l),i(!1)})}),t.$$set=s=>{"handleWakeup"in s&&n(2,i=s.handleWakeup)},[l,r,i]}class sl extends te{constructor(e){super(),ee(this,e,il,rl,J,{handleWakeup:2})}}function ol(t){let e,n,l,r,i,s,o,a,c,f,d,g,h,m,y,v,b,q,k,L,_,M,x,S,$;return{c(){e=w("div"),n=w("div"),l=w("p"),l.textContent="Welcome aboard!",r=O(),i=w("div"),s=w("div"),o=w("label"),a=w("input"),c=O(),f=w("button"),f.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 inline rounded-full"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"></path></svg>',d=O(),g=w("p"),g.textContent="copy your Spotify profile link from your account page",h=O(),m=w("div"),y=w("div"),v=w("label"),b=w("input"),q=O(),k=w("span"),k.textContent="save",L=O(),_=w("button"),_.textContent="continue",M=O(),x=w("details"),x.innerHTML=`<summary class="font-bold mb-2">Know Cartier Manager, The Free Spotify Playlist Downloader</summary> <p class="mb-4">Mobile-friendly, free-to-use Spotify playlist downloader. Share your
          Spotify profile link to effortlessly download all your public
          playlists.</p> <p>Powered by <code>spotify-dl</code> on our servers, Cartier finds and downloads
          songs from YouTube and Deezer based on Spotify data.</p>`,u(l,"class","text-3xl font-black text-white border-border border-b-2 rounded-xl px-2 pb-1"),u(a,"id","spotifyprofilelinkinput"),u(a,"type","text"),u(a,"class","w-full"),u(a,"placeholder","type Spotify profile link"),u(a,"autocomplete","url"),u(a,"aria-label","type spotify profile link"),u(o,"for","spotifyprofilelinkinput"),u(f,"class","bg-background text-white ring-1 ring-border"),u(f,"aria-label","paste spotify profile link from clipboard"),u(s,"class","w-full flex flex-row items-center justify-center space-x-2"),u(g,"class","text-xs svg-icon mt-[0.5em]"),u(i,"class","flex flex-col items-center justify-center"),u(b,"type","checkbox"),u(b,"id","dopersistbtn"),u(b,"class","inline"),u(k,"class","align-middle"),u(v,"for","dopersistbtn"),u(v,"class","text-base flex flex-row space-x-2 bg-black p-2 rounded-md"),u(_,"class","hover:scale-110"),u(y,"class","flex flex-row items-center justify-center space-x-3"),u(x,"class","text-xs w-11/12"),u(m,"class","flex flex-col space-x-[0.5em]"),u(n,"class","flex flex-col items-center text-center justify-center bg-foreground ring-1 ring-border rounded-md w-11/12 space-y-7 p-3 max-w-[90vw] h-full"),u(e,"class","flex flex-col justify-center items-center")},m(j,Z){A(j,e,Z),p(e,n),p(n,l),p(n,r),p(n,i),p(i,s),p(s,o),p(o,a),Ge(a,t[0]),p(s,c),p(s,f),p(i,d),p(i,g),p(n,h),p(n,m),p(m,y),p(y,v),p(v,b),b.checked=t[1],p(v,q),p(v,k),p(y,L),p(y,_),p(m,M),p(m,x),S||($=[H(a,"input",t[5]),H(f,"click",t[2]),H(b,"change",t[6]),H(_,"click",t[3])],S=!0)},p(j,[Z]){Z&1&&a.value!==j[0]&&Ge(a,j[0]),Z&2&&(b.checked=j[1])},i:D,o:D,d(j){j&&C(e),S=!1,G($)}}}function al(t,e,n){let{handleUserid:l}=e,r="",i=!0;const s=async()=>{navigator.clipboard.readText?n(0,r=await navigator.clipboard.readText()):N("unable to use the clipboard",!1,.5)},o=()=>{let f;try{f=new URL(r)}catch{n(0,r="");return}const d=f.pathname.split("/")[2];i&&(localStorage.setItem("cartier-userid",d),N("login information saved!")),l(d)};function a(){r=this.value,n(0,r)}function c(){i=this.checked,n(1,i)}return t.$$set=f=>{"handleUserid"in f&&n(4,l=f.handleUserid)},[r,i,s,o,l,a,c]}class cl extends te{constructor(e){super(),ee(this,e,al,ol,J,{handleUserid:4})}}function ul(t){return new Worker("/cartier/assets/fsWorker-DvOHPA-1.js",{name:t==null?void 0:t.name})}var U=(t=>(t[t.PLAYLISTS=0]="PLAYLISTS",t[t.DOWNLOADED=1]="DOWNLOADED",t[t.SETTINGS=2]="SETTINGS",t[t.ACCOUNT=3]="ACCOUNT",t))(U||{});const z=ue({logged:!1,offline:!0,user:{},playlists:{downloaded:[],all:[]},view:{tab:0}}),de=ue({handle:{root:{},cartierFile:{},tracksDir:{}}}),B=ue({playlists:[],tracks:[],info:{type:"cartier-file",version:1},data:{}}),dl=ue({io:{},loaded:!1}),Be={write:(t,e)=>{const n=new ul;return n.postMessage({mode:"write",handle:t,content:e}),new Promise((l,r)=>{n.addEventListener("message",()=>{l(),n.terminate()})})}},oe={setOPFSHandle:async()=>{let t=I(de);t.handle.root=await navigator.storage.getDirectory(),t.handle.cartierFile=await t.handle.root.getFileHandle("cartier.json",{create:!0}),t.handle.tracksDir=await t.handle.root.getDirectoryHandle("tracks",{create:!0}),de.set(t)},bufferCartierFile:async()=>{let t=I(de);const e=await t.handle.cartierFile.getFile();B.set(JSON.parse(await e.text())),B.subscribe(async n=>{await Be.write(t.handle.cartierFile,JSON.stringify(n))})},initCartierFile:async()=>{await oe.setOPFSHandle();let t=I(de);(await t.handle.cartierFile.getFile()).size==0&&(console.info("cartier file is empty!"),await Be.write(t.handle.cartierFile,JSON.stringify(I(B)))),await oe.bufferCartierFile()},login:async(t="",e={})=>{if(Object.keys(e).length==0){if(e=await re.getUserInfo(t),e.success==!1)return!1;e=e.data;let n=I(B);n.data=e,B.set(n)}z.set({...I(z),...e,logged:!0})},logout:async()=>{localStorage.removeItem("cartier-userid"),z.update(t=>(t.logged=!1,t.playlists={all:[],downloaded:[]},t.user={},t))},init:async()=>{await oe.initCartierFile();let t=I(z),e=I(B);e.data&&Object.keys(e.data).length>0&&(t.offline?oe.login("",e.data):oe.login(e.data.user.id))}};function lt(t,e,n){const l=t.slice();return l[8]=e[n][0],l[9]=e[n][1],l}function nt(t){let e,n;return{c(){e=Y("svg"),n=Y("path"),u(n,"stroke-linecap","round"),u(n,"stroke-linejoin","round"),u(n,"d","M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z"),u(n,"class","svelte-1qpwcl7"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"fill","none"),u(e,"viewBox","0 0 24 24"),u(e,"stroke-width","1.5"),u(e,"stroke","currentColor"),u(e,"class","w-[1em] svelte-1qpwcl7")},m(l,r){A(l,e,r),p(e,n)},d(l){l&&C(e)}}}function rt(t){let e,n,l=t[8].startsWith("r"),r,i=t[8].slice(1).split("_").join(" ")+"",s,o,a,c=t[9]+"",f,d=l&&nt();return{c(){e=w("tr"),n=w("td"),d&&d.c(),r=O(),s=F(i),o=O(),a=w("td"),f=F(c),u(n,"class","svg-icon p-2 svelte-1qpwcl7"),u(a,"class","bg-transparent border-l-2 border-border svelte-1qpwcl7"),u(e,"class","odd:bg-foreground even:bg-background svelte-1qpwcl7")},m(g,h){A(g,e,h),p(e,n),d&&d.m(n,null),p(n,r),p(n,s),p(e,o),p(e,a),p(a,f)},p(g,h){h&1&&(l=g[8].startsWith("r")),l?d||(d=nt(),d.c(),d.m(n,r)):d&&(d.d(1),d=null),h&1&&i!==(i=g[8].slice(1).split("_").join(" ")+"")&&Q(s,i),h&1&&c!==(c=g[9]+"")&&Q(f,c)},d(g){g&&C(e),d&&d.d()}}}function fl(t){let e,n,l,r,i,s,o,a,c,f,d,g,h,m,y,v,b,q,k,L=le(Object.entries(t[0])),_=[];for(let M=0;M<L.length;M+=1)_[M]=rt(lt(t,L,M));return{c(){e=w("div"),n=w("table"),l=w("thead"),l.innerHTML='<th class="svelte-1qpwcl7">parameter</th><th class="svelte-1qpwcl7">value</th>',r=O(),i=w("tbody");for(let M=0;M<_.length;M+=1)_[M].c();s=O(),o=w("div"),a=w("button"),a.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-[1em] svelte-1qpwcl7"><path fill-rule="evenodd" d="M8.478 1.6a.75.75 0 0 1 .273 1.026 3.72 3.72 0 0 0-.425 1.121c.058.058.118.114.18.168A4.491 4.491 0 0 1 12 2.25c1.413 0 2.673.651 3.497 1.668.06-.054.12-.11.178-.167a3.717 3.717 0 0 0-.426-1.125.75.75 0 1 1 1.298-.752 5.22 5.22 0 0 1 .671 2.046.75.75 0 0 1-.187.582c-.241.27-.505.52-.787.749a4.494 4.494 0 0 1 .216 2.1c-.106.792-.753 1.295-1.417 1.403-.182.03-.364.057-.547.081.152.227.273.476.359.742a23.122 23.122 0 0 0 3.832-.803 23.241 23.241 0 0 0-.345-2.634.75.75 0 0 1 1.474-.28c.21 1.115.348 2.256.404 3.418a.75.75 0 0 1-.516.75c-1.527.499-3.119.854-4.76 1.049-.074.38-.22.735-.423 1.05 2.066.209 4.058.672 5.943 1.358a.75.75 0 0 1 .492.75 24.665 24.665 0 0 1-1.189 6.25.75.75 0 0 1-1.425-.47 23.14 23.14 0 0 0 1.077-5.306c-.5-.169-1.009-.32-1.524-.455.068.234.104.484.104.746 0 3.956-2.521 7.5-6 7.5-3.478 0-6-3.544-6-7.5 0-.262.037-.511.104-.746-.514.135-1.022.286-1.522.455.154 1.838.52 3.616 1.077 5.307a.75.75 0 1 1-1.425.468 24.662 24.662 0 0 1-1.19-6.25.75.75 0 0 1 .493-.749 24.586 24.586 0 0 1 4.964-1.24h.01c.321-.046.644-.085.969-.118a2.983 2.983 0 0 1-.424-1.05 24.614 24.614 0 0 1-4.76-1.05.75.75 0 0 1-.516-.75c.057-1.16.194-2.302.405-3.417a.75.75 0 0 1 1.474.28c-.164.862-.28 1.74-.345 2.634 1.237.371 2.517.642 3.832.803.085-.266.207-.515.359-.742a18.698 18.698 0 0 1-.547-.08c-.664-.11-1.311-.612-1.417-1.404a4.535 4.535 0 0 1 .217-2.103 6.788 6.788 0 0 1-.788-.751.75.75 0 0 1-.187-.583 5.22 5.22 0 0 1 .67-2.04.75.75 0 0 1 1.026-.273Z" clip-rule="evenodd" class="svelte-1qpwcl7"></path></svg> <a href="https://github.com/reold/cartier/issues/new" target="_blank" class="svelte-1qpwcl7">report a bug</a>',c=O(),f=w("button"),f.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-[1em] svelte-1qpwcl7"><path d="M4.08 5.227A3 3 0 0 1 6.979 3H17.02a3 3 0 0 1 2.9 2.227l2.113 7.926A5.228 5.228 0 0 0 18.75 12H5.25a5.228 5.228 0 0 0-3.284 1.153L4.08 5.227Z" class="svelte-1qpwcl7"></path><path fill-rule="evenodd" d="M5.25 13.5a3.75 3.75 0 1 0 0 7.5h13.5a3.75 3.75 0 1 0 0-7.5H5.25Zm10.5 4.5a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Zm3.75-.75a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z" clip-rule="evenodd" class="svelte-1qpwcl7"></path></svg> <p class="svelte-1qpwcl7">Render Server</p>',d=O(),g=w("button"),g.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-[1em] svelte-1qpwcl7"><path d="M4.08 5.227A3 3 0 0 1 6.979 3H17.02a3 3 0 0 1 2.9 2.227l2.113 7.926A5.228 5.228 0 0 0 18.75 12H5.25a5.228 5.228 0 0 0-3.284 1.153L4.08 5.227Z" class="svelte-1qpwcl7"></path><path fill-rule="evenodd" d="M5.25 13.5a3.75 3.75 0 1 0 0 7.5h13.5a3.75 3.75 0 1 0 0-7.5H5.25Zm10.5 4.5a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Zm3.75-.75a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z" clip-rule="evenodd" class="svelte-1qpwcl7"></path></svg> <p class="svelte-1qpwcl7">Koyeb server</p>',h=O(),m=w("button"),m.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-[1em] svelte-1qpwcl7"><path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99" class="svelte-1qpwcl7"></path></svg> <p class="svelte-1qpwcl7">refresh</p> ',y=w("button"),y.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-[1em] svelte-1qpwcl7"><path fill-rule="evenodd" d="M16.5 3.75a1.5 1.5 0 0 1 1.5 1.5v13.5a1.5 1.5 0 0 1-1.5 1.5h-6a1.5 1.5 0 0 1-1.5-1.5V15a.75.75 0 0 0-1.5 0v3.75a3 3 0 0 0 3 3h6a3 3 0 0 0 3-3V5.25a3 3 0 0 0-3-3h-6a3 3 0 0 0-3 3V9A.75.75 0 1 0 9 9V5.25a1.5 1.5 0 0 1 1.5-1.5h6Zm-5.03 4.72a.75.75 0 0 0 0 1.06l1.72 1.72H2.25a.75.75 0 0 0 0 1.5h10.94l-1.72 1.72a.75.75 0 1 0 1.06 1.06l3-3a.75.75 0 0 0 0-1.06l-3-3a.75.75 0 0 0-1.06 0Z" clip-rule="evenodd" class="svelte-1qpwcl7"></path></svg> <p class="svelte-1qpwcl7">logout</p>',v=O(),b=w("button"),b.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-[1em] svelte-1qpwcl7"><path fill-rule="evenodd" d="M16.5 4.478v.227a48.816 48.816 0 0 1 3.878.512.75.75 0 1 1-.256 1.478l-.209-.035-1.005 13.07a3 3 0 0 1-2.991 2.77H8.084a3 3 0 0 1-2.991-2.77L4.087 6.66l-.209.035a.75.75 0 0 1-.256-1.478A48.567 48.567 0 0 1 7.5 4.705v-.227c0-1.564 1.213-2.9 2.816-2.951a52.662 52.662 0 0 1 3.369 0c1.603.051 2.815 1.387 2.815 2.951Zm-6.136-1.452a51.196 51.196 0 0 1 3.273 0C14.39 3.05 15 3.684 15 4.478v.113a49.488 49.488 0 0 0-6 0v-.113c0-.794.609-1.428 1.364-1.452Zm-.355 5.945a.75.75 0 1 0-1.5.058l.347 9a.75.75 0 1 0 1.499-.058l-.346-9Zm5.48.058a.75.75 0 1 0-1.498-.058l-.347 9a.75.75 0 0 0 1.5.058l.345-9Z" clip-rule="evenodd" class="svelte-1qpwcl7"></path></svg> <p class="svelte-1qpwcl7">delete all downloads</p>',u(l,"class","text-xl svelte-1qpwcl7"),u(i,"class","svelte-1qpwcl7"),u(n,"class","text-sm ring-1 ring-border rounded-md min-w-[95vw] svelte-1qpwcl7"),u(a,"class","bg-black text-white svg-icon col-span-5 svelte-1qpwcl7"),u(f,"class","bg-orange-500 text-black svg-icon col-span-5 svelte-1qpwcl7"),u(g,"class","bg-orange-500 text-black svg-icon col-span-5 svelte-1qpwcl7"),u(m,"class","bg-primary text-black svg-icon col-span-5 svelte-1qpwcl7"),u(y,"class","bg-red-500 text-white svg-icon col-span-10 svelte-1qpwcl7"),u(b,"class","bg-red-500 text-white svg-icon col-span-10 svelte-1qpwcl7"),u(o,"class","grid grid-cols-10 gap-2 btns-tab font-bold min-w-[95vw] svelte-1qpwcl7"),u(e,"class","h-[82vh] overflow-y-scroll w-[100vw] flex flex-col items-center justify-center svelte-1qpwcl7")},m(M,x){A(M,e,x),p(e,n),p(n,l),p(n,r),p(n,i);for(let S=0;S<_.length;S+=1)_[S]&&_[S].m(i,null);p(e,s),p(e,o),p(o,a),p(o,c),p(o,f),p(o,d),p(o,g),p(o,h),p(o,m),p(o,y),p(o,v),p(o,b),q||(k=[H(a,"click",t[2]),H(f,"click",t[4]),H(g,"click",t[5]),H(m,"click",t[2]),H(y,"click",t[3]),H(b,"click",t[1])],q=!0)},p(M,[x]){if(x&1){L=le(Object.entries(M[0]));let S;for(S=0;S<L.length;S+=1){const $=lt(M,L,S);_[S]?_[S].p($,x):(_[S]=rt($),_[S].c(),_[S].m(i,null))}for(;S<_.length;S+=1)_[S].d(1);_.length=L.length}},i:D,o:D,d(M){M&&C(e),Ce(_,M),q=!1,G(k)}}}function pl(t,e,n){let l,r;W(t,z,d=>n(6,l=d)),W(t,de,d=>n(7,r=d));let i={};const s=()=>{N("deleting all downloads and refreshing",!0,10,async d=>{await r.handle.root.removeEntry("tracks",{recursive:!0}),await r.handle.root.removeEntry("cartier.json"),d(),window.location.reload()})},o=()=>{N("loading settings",!0,5,async d=>{let g=0,h="";{const m=await navigator.storage.estimate();m&&(g=m.usage/1024**2),n(0,i.ropfs_used=`${g.toFixed(1)} MB`,i)}if(!l.offline){const y=await(await fetch("https://api.github.com/repos/reold/cartier/deployments")).json(),v=new Date(y[0].updated_at),q=new Date().getTime()-v.getTime(),k=Math.floor(q/1e3),L=Math.floor(k/60),_=Math.floor(L/60),M=Math.floor(_/24);let x;M>0?x=M===1?"1 day":`${M} days`:_>0?x=_===1?"1 hour":`${_} hours`:L>0?x=L===1?"1 minute":`${L} minutes`:x=k===1?"1 second":`${k} seconds`,h=`${x} ago by ${y[0].creator.login}`,n(0,i.rfrontend_updated=h,i)}n(0,i={...i,rsaved_userid:localStorage.getItem("cartier-userid")||"not saved",rserver_url:window["cartier-server-url"],roffline:l.offline,wthank_you_for:"testing our beta version!"}),d()})};return Le(o),[i,s,o,async()=>{await oe.logout()},()=>{window["cartier-server-url"]="https://cartier-backend-1.onrender.com",N("waking up Render server",!0,10,async d=>{await re.getRoot(),d(),o()})},()=>{window["cartier-server-url"]="https://cartier-reold.koyeb.app",N("waking up Koyeb server",!0,10,async d=>{await re.getRoot(),d(),o()})}]}class gl extends te{constructor(e){super(),ee(this,e,pl,fl,J,{})}}const V=ue({loaded:!1,queue:[],playback:{handle:{},id:"",name:"",dur:1,time:0,playing:!1}}),R={play:async()=>{let t=I(V);t.loaded||(t.loaded=!0),t.playback.playing=!0;const n=await(await I(de).handle.tracksDir.getFileHandle(`${t.playback.id}.mp3`)).getFile(),l=URL.createObjectURL(n);t.playback.handle=new Audio(l),t.playback.handle.play(),t.playback.handle.addEventListener("loadeddata",()=>{V.update(r=>(r.playback.dur=r.playback.handle.duration,r))}),t.playback.handle.addEventListener("timeupdate",()=>{V.update(r=>(r.playback.time=r.playback.handle.currentTime,r))}),t.playback.handle.addEventListener("ended",()=>{I(V).queue.length>0&&(R.next(),R.play())}),V.set(t)},pause:()=>{let t=I(V);t.playback.handle.pause(),t.playback.playing=!1,V.set(t)},resume:()=>{let t=I(V);t.playback.handle.play(),t.playback.playing=!0,V.set(t)},next:()=>{let t=I(V),e=t.queue[0];return e?(t.playback.playing&&R.pause(),t.playback.name=e.name,t.playback.id=e.id,t.queue.splice(0,1),V.set(t),!0):!1},queue:{addTrack:(t,e=!1)=>{let n=I(V),l=I(B);for(let r of l.tracks)if(r.id==t){n.queue=e?[{id:t,name:r.name},...n.queue]:[...n.queue,{id:t,name:r.name}];break}V.set(n)},addPlaylist:(t,e=!1)=>{const l=I(B).playlists.find(r=>r.id==t);l&&(e&&l.tracks.reverse(),l.tracks.forEach(r=>{R.queue.addTrack(r,e)}))}}};function it(t,e,n){const l=t.slice();return l[6]=e[n],l}function st(t){let e,n,l,r=t[6].name+"",i,s;return{c(){e=w("li"),n=Y("svg"),l=Y("path"),i=F(r),s=O(),u(l,"fill-rule","evenodd"),u(l,"d","M19.952 1.651a.75.75 0 0 1 .298.599V16.303a3 3 0 0 1-2.176 2.884l-1.32.377a2.553 2.553 0 1 1-1.403-4.909l2.311-.66a1.5 1.5 0 0 0 1.088-1.442V6.994l-9 2.572v9.737a3 3 0 0 1-2.176 2.884l-1.32.377a2.553 2.553 0 1 1-1.402-4.909l2.31-.66a1.5 1.5 0 0 0 1.088-1.442V5.25a.75.75 0 0 1 .544-.721l10.5-3a.75.75 0 0 1 .658.122Z"),u(l,"clip-rule","evenodd"),u(n,"xmlns","http://www.w3.org/2000/svg"),u(n,"viewBox","0 0 24 24"),u(n,"fill","currentColor"),u(n,"class","w-[2ch] inline mr-1"),u(e,"class","truncate")},m(o,a){A(o,e,a),p(e,n),p(n,l),p(e,i),p(e,s)},p(o,a){a&2&&r!==(r=o[6].name+"")&&Q(i,r)},d(o){o&&C(e)}}}function ml(t){let e,n,l,r=t[0].name+"",i,s,o,a,c=t[0].owner+"",f,d,g,h,m,y,v,b,q,k,L,_=le(t[1]),M=[];for(let x=0;x<_.length;x+=1)M[x]=st(it(t,_,x));return{c(){e=w("div"),n=w("div"),l=w("p"),i=F(r),s=O(),o=w("p"),a=F("by "),f=F(c),d=O(),g=w("ol");for(let x=0;x<M.length;x+=1)M[x].c();h=O(),m=w("button"),m.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-[2em]"><path fill-rule="evenodd" d="M4.5 5.653c0-1.427 1.529-2.33 2.779-1.643l11.54 6.347c1.295.712 1.295 2.573 0 3.286L7.28 19.99c-1.25.687-2.779-.217-2.779-1.643V5.653Z" clip-rule="evenodd"></path></svg>',y=O(),v=w("button"),v.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-[2em]"><path d="M5.625 3.75a2.625 2.625 0 1 0 0 5.25h12.75a2.625 2.625 0 0 0 0-5.25H5.625ZM3.75 11.25a.75.75 0 0 0 0 1.5h16.5a.75.75 0 0 0 0-1.5H3.75ZM3 15.75a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75ZM3.75 18.75a.75.75 0 0 0 0 1.5h16.5a.75.75 0 0 0 0-1.5H3.75Z"></path></svg>',b=O(),q=w("button"),q.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-[2em]"><path fill-rule="evenodd" d="M16.5 4.478v.227a48.816 48.816 0 0 1 3.878.512.75.75 0 1 1-.256 1.478l-.209-.035-1.005 13.07a3 3 0 0 1-2.991 2.77H8.084a3 3 0 0 1-2.991-2.77L4.087 6.66l-.209.035a.75.75 0 0 1-.256-1.478A48.567 48.567 0 0 1 7.5 4.705v-.227c0-1.564 1.213-2.9 2.816-2.951a52.662 52.662 0 0 1 3.369 0c1.603.051 2.815 1.387 2.815 2.951Zm-6.136-1.452a51.196 51.196 0 0 1 3.273 0C14.39 3.05 15 3.684 15 4.478v.113a49.488 49.488 0 0 0-6 0v-.113c0-.794.609-1.428 1.364-1.452Zm-.355 5.945a.75.75 0 1 0-1.5.058l.347 9a.75.75 0 1 0 1.499-.058l-.346-9Zm5.48.058a.75.75 0 1 0-1.498-.058l-.347 9a.75.75 0 0 0 1.5.058l.345-9Z" clip-rule="evenodd"></path></svg>',u(l,"class","text-xl font-bold"),u(o,"class","-mt-1"),u(n,"class","flex flex-col items-center justify-center space-x-2 col-span-2 row-span-2"),u(g,"class","ring-1 ring-border col-span-3 p-2 rounded-t-md bg-foreground overflow-x-hidden overflow-y-scroll"),u(m,"class","svg-icon ring-1 ring-border p-0 text-xs rounded-none rounded-bl-md"),u(v,"class","svg-icon ring-1 ring-border p-0 text-xs rounded-none"),u(q,"class","svg-icon ring-1 ring-border bg-red-500 text-white p-0 text-xs rounded-none rounded-br-md"),u(e,"class","bg-green-600 ring-1 ring-border w-[95%] rounded-md min-h-[15vh] max-h-[20vh] text-xs grid grid-cols-5")},m(x,S){A(x,e,S),p(e,n),p(n,l),p(l,i),p(n,s),p(n,o),p(o,a),p(o,f),p(e,d),p(e,g);for(let $=0;$<M.length;$+=1)M[$]&&M[$].m(g,null);p(e,h),p(e,m),p(e,y),p(e,v),p(e,b),p(e,q),k||(L=[H(m,"click",t[3]),H(v,"click",t[4]),H(q,"click",t[2])],k=!0)},p(x,[S]){if(S&1&&r!==(r=x[0].name+"")&&Q(i,r),S&1&&c!==(c=x[0].owner+"")&&Q(f,c),S&2){_=le(x[1]);let $;for($=0;$<_.length;$+=1){const j=it(x,_,$);M[$]?M[$].p(j,S):(M[$]=st(j),M[$].c(),M[$].m(g,null))}for(;$<M.length;$+=1)M[$].d(1);M.length=_.length}},i:D,o:D,d(x){x&&C(e),Ce(M,x),k=!1,G(L)}}}function hl(t,e,n){let l;W(t,B,c=>n(5,l=c));let{playlist:r}=e,i=[];Le(()=>{r.tracks.forEach(c=>{for(let f of l.tracks)if(f.id==c){n(1,i=[...i,{id:f.id,name:f.name}]);break}})});const s=()=>{let c=l.playlists;c.splice(l.playlists.indexOf(r),1),T(B,l.playlists=c,l),N(`removed "${r.name}" from downloads`,!1,2)},o=()=>{R.queue.addPlaylist(r.id,!0),R.next(),R.play()},a=()=>{R.queue.addPlaylist(r.id),N(`"${r.name}" added to queue`)};return t.$$set=c=>{"playlist"in c&&n(0,r=c.playlist)},[r,i,s,o,a]}class wl extends te{constructor(e){super(),ee(this,e,hl,ml,J,{playlist:0})}}function ot(t){return Object.prototype.toString.call(t)==="[object Date]"}function Ue(t,e){if(t===e||t!==t)return()=>t;const n=typeof t;if(n!==typeof e||Array.isArray(t)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(t)){const l=e.map((r,i)=>Ue(t[i],r));return r=>l.map(i=>i(r))}if(n==="object"){if(!t||!e)throw new Error("Object cannot be null");if(ot(t)&&ot(e)){t=t.getTime(),e=e.getTime();const i=e-t;return s=>new Date(t+s*i)}const l=Object.keys(e),r={};return l.forEach(i=>{r[i]=Ue(t[i],e[i])}),i=>{const s={};return l.forEach(o=>{s[o]=r[o](i)}),s}}if(n==="number"){const l=e-t;return r=>t+r*l}throw new Error(`Cannot interpolate ${n} values`)}function Ee(t,e={}){const n=ue(t);let l,r=t;function i(s,o){if(t==null)return n.set(t=s),Promise.resolve();r=s;let a=l,c=!1,{delay:f=0,duration:d=400,easing:g=We,interpolate:h=Ue}=Fe(Fe({},e),o);if(d===0)return a&&(a.abort(),a=null),n.set(t=r),Promise.resolve();const m=ze()+f;let y;return l=Re(v=>{if(v<m)return!0;c||(y=h(t,s),typeof d=="function"&&(d=d(t,s)),c=!0),a&&(a.abort(),a=null);const b=v-m;return b>d?(n.set(t=s),!1):(n.set(t=y(g(b/d))),!0)}),l.promise}return{set:i,update:(s,o)=>i(s(r,t),o),subscribe:n.subscribe}}function at(t,e,n){const l=t.slice();return l[13]=e[n],l}function ct(t){let e,n;return{c(){e=w("div"),u(e,"class","absolute w-full h-full rounded-md blur-[2px]"),u(e,"style",n=t[0].images&&t[0].images[0]?`background-image: url('${t[0].images[0].url}');
    background-position: center;
    background-size: cover;
    background-blend-mode: multiply;
    background-color: rgba(0, 0, 0, 0.6)
    `:"background-color: #22272E")},m(l,r){A(l,e,r)},p(l,r){r&1&&n!==(n=l[0].images&&l[0].images[0]?`background-image: url('${l[0].images[0].url}');
    background-position: center;
    background-size: cover;
    background-blend-mode: multiply;
    background-color: rgba(0, 0, 0, 0.6)
    `:"background-color: #22272E")&&u(e,"style",n)},d(l){l&&C(e)}}}function bl(t){let e,n;return{c(){e=Y("svg"),n=Y("path"),u(n,"stroke-linecap","round"),u(n,"stroke-linejoin","round"),u(n,"d","M18.364 18.364A9 9 0 0 0 5.636 5.636m12.728 12.728A9 9 0 0 1 5.636 5.636m12.728 12.728L5.636 5.636"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"fill","none"),u(e,"viewBox","0 0 24 24"),u(e,"stroke-width","1.5"),u(e,"stroke","currentColor"),u(e,"class","w-[10vh] h-[10vh] col-span-3 m-auto")},m(l,r){A(l,e,r),p(e,n)},p:D,d(l){l&&C(e)}}}function vl(t){let e,n;return{c(){e=w("img"),u(e,"loading","lazy"),we(e.src,n=t[0].images[0].url)||u(e,"src",n),u(e,"class","rounded-full max-h-[10vh] shadow-black shadow-md col-span-3 m-auto"),u(e,"alt","playlist's cover")},m(l,r){A(l,e,r)},p(l,r){r&1&&!we(e.src,n=l[0].images[0].url)&&u(e,"src",n)},d(l){l&&C(e)}}}function _l(t){let e,n=t[0].owner.display_name+"",l;return{c(){e=F("by "),l=F(n)},m(r,i){A(r,e,i),A(r,l,i)},p(r,i){i&1&&n!==(n=r[0].owner.display_name+"")&&Q(l,n)},d(r){r&&(C(e),C(l))}}}function yl(t){let e=t[0].description+"",n;return{c(){n=F(e)},m(l,r){A(l,n,r)},p(l,r){r&1&&e!==(e=l[0].description+"")&&Q(n,e)},d(l){l&&C(n)}}}function ut(t){let e,n,l,r,i,s,o,a;function c(g,h){return g[2].download.done?$l:kl}let f=c(t),d=f(t);return{c(){e=w("div"),n=w("button"),l=Y("svg"),r=Y("path"),s=O(),d.c(),u(r,"stroke-linecap","round"),u(r,"stroke-linejoin","round"),u(r,"d","m19.5 8.25-7.5 7.5-7.5-7.5"),u(l,"xmlns","http://www.w3.org/2000/svg"),u(l,"fill","none"),u(l,"viewBox","0 0 24 24"),u(l,"stroke-width","2"),u(l,"stroke","currentColor"),u(l,"class",i="w-[4ch] origin-center transition-transform duration-500 "+(t[2].showMore?"rotate-180":"")),u(n,"class","text-xs svg-icon bg-black/20 p-0 text-white"),u(e,"class","flex flex-row justify-start items-center space-x-2 col-span-7")},m(g,h){A(g,e,h),p(e,n),p(n,l),p(l,r),p(e,s),d.m(e,null),o||(a=H(n,"click",t[6]),o=!0)},p(g,h){h&4&&i!==(i="w-[4ch] origin-center transition-transform duration-500 "+(g[2].showMore?"rotate-180":""))&&u(l,"class",i),f===(f=c(g))&&d?d.p(g,h):(d.d(1),d=f(g),d&&(d.c(),d.m(e,null)))},d(g){g&&C(e),d.d(),o=!1,a()}}}function kl(t){let e,n,l,r;function i(a,c){return a[2].downloading?Ll:xl}let s=i(t),o=s(t);return{c(){e=w("button"),o.c(),u(e,"class","text-xs svg-icon"),e.disabled=n=t[2].downloading||t[2].download.done},m(a,c){A(a,e,c),o.m(e,null),l||(r=H(e,"click",t[9]),l=!0)},p(a,c){s!==(s=i(a))&&(o.d(1),o=s(a),o&&(o.c(),o.m(e,null))),c&4&&n!==(n=a[2].downloading||a[2].download.done)&&(e.disabled=n)},d(a){a&&C(e),o.d(),l=!1,r()}}}function $l(t){let e,n,l,r,i;return{c(){e=w("button"),e.textContent="save",n=O(),l=w("button"),l.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-[2ch]"><path fill-rule="evenodd" d="M12 2.25a.75.75 0 0 1 .75.75v11.69l3.22-3.22a.75.75 0 1 1 1.06 1.06l-4.5 4.5a.75.75 0 0 1-1.06 0l-4.5-4.5a.75.75 0 1 1 1.06-1.06l3.22 3.22V3a.75.75 0 0 1 .75-.75Zm-9 13.5a.75.75 0 0 1 .75.75v2.25a1.5 1.5 0 0 0 1.5 1.5h13.5a1.5 1.5 0 0 0 1.5-1.5V16.5a.75.75 0 0 1 1.5 0v2.25a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3V16.5a.75.75 0 0 1 .75-.75Z" clip-rule="evenodd"></path></svg>

                  local mp3`,u(e,"class","text-xs svg-icon bg-green-700 text-white"),u(l,"class","text-xs svg-icon")},m(s,o){A(s,e,o),A(s,n,o),A(s,l,o),r||(i=[H(e,"click",t[8]),H(l,"click",t[7])],r=!0)},p:D,d(s){s&&(C(e),C(n),C(l)),r=!1,G(i)}}}function xl(t){let e,n,l;return{c(){e=Y("svg"),n=Y("path"),l=F(`

                    download`),u(n,"fill-rule","evenodd"),u(n,"d","M12 2.25a.75.75 0 0 1 .75.75v11.69l3.22-3.22a.75.75 0 1 1 1.06 1.06l-4.5 4.5a.75.75 0 0 1-1.06 0l-4.5-4.5a.75.75 0 1 1 1.06-1.06l3.22 3.22V3a.75.75 0 0 1 .75-.75Zm-9 13.5a.75.75 0 0 1 .75.75v2.25a1.5 1.5 0 0 0 1.5 1.5h13.5a1.5 1.5 0 0 0 1.5-1.5V16.5a.75.75 0 0 1 1.5 0v2.25a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3V16.5a.75.75 0 0 1 .75-.75Z"),u(n,"clip-rule","evenodd"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"viewBox","0 0 24 24"),u(e,"fill","currentColor"),u(e,"class","w-[2ch]")},m(r,i){A(r,e,i),p(e,n),A(r,l,i)},d(r){r&&(C(e),C(l))}}}function Ll(t){let e;return{c(){e=F("downloading")},m(n,l){A(n,e,l)},d(n){n&&C(e)}}}function dt(t){let e,n,l,r=t[2].tracks.length+"",i,s,o,a,c,f=le(t[2].tracks),d=[];for(let g=0;g<f.length;g+=1)d[g]=ft(at(t,f,g));return{c(){e=w("div"),n=w("div"),l=w("p"),i=F(r),s=F(" tracks"),o=O();for(let g=0;g<d.length;g+=1)d[g].c();u(l,"class","bg-primary rounded-full p-2 text-black"),u(n,"class","overflow-hidden overflow-x-scroll flex flex-row items-center space-x-2 p-2"),u(e,"class","-mt-1 w-full bg-foreground ring-1 ring-border rounded-b-md text-xs flex flex-row items-center justify-center")},m(g,h){A(g,e,h),p(e,n),p(n,l),p(l,i),p(l,s),p(n,o);for(let m=0;m<d.length;m+=1)d[m]&&d[m].m(n,null);c=!0},p(g,h){if((!c||h&4)&&r!==(r=g[2].tracks.length+"")&&Q(i,r),h&4){f=le(g[2].tracks);let m;for(m=0;m<f.length;m+=1){const y=at(g,f,m);d[m]?d[m].p(y,h):(d[m]=ft(y),d[m].c(),d[m].m(n,null))}for(;m<d.length;m+=1)d[m].d(1);d.length=f.length}},i(g){c||(g&&se(()=>{c&&(a||(a=be(e,Se,{duration:500},!0)),a.run(1))}),c=!0)},o(g){g&&(a||(a=be(e,Se,{duration:500},!1)),a.run(0)),c=!1},d(g){g&&C(e),Ce(d,g),g&&a&&a.end()}}}function Ml(t){let e;return{c(){e=w("div"),e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-[5vh]"><path stroke-linecap="round" stroke-linejoin="round" d="M18.364 18.364A9 9 0 0 0 5.636 5.636m12.728 12.728A9 9 0 0 1 5.636 5.636m12.728 12.728L5.636 5.636"></path></svg> ',u(e,"class","shadow-md shadow-black rounded-full")},m(n,l){A(n,e,l)},p:D,d(n){n&&C(e)}}}function Sl(t){let e,n,l;return{c(){e=w("img"),u(e,"loading","lazy"),we(e.src,n=t[13].images[t[13].images.length-1].url)||u(e,"src",n),u(e,"class",l="aspect-square h-[5vh] ring-1 ring-border rounded-full shadow-sm shadow-black will-change-auto "+(t[2].downloading?(t[2].download.status[t[13].id]=="downloading"?" rotating-image":"")+(t[2].download.status[t[13].id]=="ready"?"ring-green-500":"")+(t[2].download.status[t[13].id]=="failed"?" ring-red-500":""):"")),u(e,"alt","album art")},m(r,i){A(r,e,i)},p(r,i){i&4&&!we(e.src,n=r[13].images[r[13].images.length-1].url)&&u(e,"src",n),i&4&&l!==(l="aspect-square h-[5vh] ring-1 ring-border rounded-full shadow-sm shadow-black will-change-auto "+(r[2].downloading?(r[2].download.status[r[13].id]=="downloading"?" rotating-image":"")+(r[2].download.status[r[13].id]=="ready"?"ring-green-500":"")+(r[2].download.status[r[13].id]=="failed"?" ring-red-500":""):""))&&u(e,"class",l)},d(r){r&&C(e)}}}function ft(t){let e;function n(i,s){return i[13].images&&i[13].images.length>0?Sl:Ml}let l=n(t),r=l(t);return{c(){r.c(),e=ve()},m(i,s){r.m(i,s),A(i,e,s)},p(i,s){l===(l=n(i))&&r?r.p(i,s):(r.d(1),r=l(i),r&&(r.c(),r.m(e.parentNode,e)))},d(i){i&&C(e),r.d(i)}}}function Cl(t){let e,n,l,r,i,s,o,a,c=t[0].name+"",f,d,g,h,m,y,v,b=!t[1]&&ct(t);function q(j,Z){return!j[1]&&j[0].images&&j[0].images.length>0?vl:bl}let k=q(t),L=k(t);function _(j,Z){return j[0].description?yl:_l}let M=_(t),x=M(t),S=!t[1]&&ut(t),$=t[2].showMore&&dt(t);return{c(){e=w("div"),n=w("div"),b&&b.c(),l=O(),r=w("div"),i=w("div"),L.c(),s=O(),o=w("div"),a=w("p"),f=F(c),d=O(),g=w("p"),x.c(),h=O(),S&&S.c(),m=O(),y=w("div"),v=O(),$&&$.c(),u(a,"class","text-left truncate font-bold -mb-1"),u(g,"class","text-left text-xs truncate mb-2"),u(o,"class","flex flex-col col-span-9"),u(i,"class","grid grid-cols-12 h-full grid-rows-1 items-center justify-center"),u(r,"class","absolute w-full h-full rounded-md"),u(n,"class","w-full h-[15vh] rounded-md relative overflow-hidden ring-1 ring-border bg-foreground"),u(y,"class","bg-primary h-[2px]"),$e(y,"width",t[3]+"%"),u(e,"class","w-[95%]")},m(j,Z){A(j,e,Z),p(e,n),b&&b.m(n,null),p(n,l),p(n,r),p(r,i),L.m(i,null),p(i,s),p(i,o),p(o,a),p(a,f),p(o,d),p(o,g),x.m(g,null),p(o,h),S&&S.m(o,null),p(e,m),p(e,y),p(e,v),$&&$.m(e,null)},p(j,[Z]){j[1]?b&&(b.d(1),b=null):b?b.p(j,Z):(b=ct(j),b.c(),b.m(n,l)),k===(k=q(j))&&L?L.p(j,Z):(L.d(1),L=k(j),L&&(L.c(),L.m(i,s))),Z&1&&c!==(c=j[0].name+"")&&Q(f,c),M===(M=_(j))&&x?x.p(j,Z):(x.d(1),x=M(j),x&&(x.c(),x.m(g,null))),j[1]?S&&(S.d(1),S=null):S?S.p(j,Z):(S=ut(j),S.c(),S.m(o,null)),Z&8&&$e(y,"width",j[3]+"%"),j[2].showMore?$?($.p(j,Z),Z&4&&E($,1)):($=dt(j),$.c(),E($,1),$.m(e,null)):$&&(ae(),P($,1,1,()=>{$=null}),ce())},i(j){E($)},o(j){P($)},d(j){j&&C(e),b&&b.d(),L.d(),x.d(),S&&S.d(),$&&$.d()}}}function ql(t,e,n){let l,r,i,s;W(t,B,v=>n(10,i=v)),W(t,de,v=>n(11,s=v));let{playlist:o}=e,{disabled:a=!1}=e;const c=ue({showMore:!1,detailedLoaded:!1,id:void 0,tracks:[],download:{stage:"",status:{},done:!1},downloading:!1,memblobs:[]});W(t,c,v=>n(2,l=v));let f=Ee(0,{duration:1e3,easing:Ot});W(t,f,v=>n(3,r=v));const d=async()=>{l.showMore?T(c,l.showMore=!1,l):(l.detailedLoaded||await g(),T(c,l.showMore=!0,l))},g=async()=>{const b=new URL(o.external_url).pathname.split("/")[2];N("loading playlist information",!0,1,async q=>{let k=await re.getPlaylistInfo(b);T(c,l.tracks=k,l),T(c,l.detailedLoaded=!0,l),q()})},h=()=>{l.memblobs.forEach(({blob:v,id:b},q)=>{const k=URL.createObjectURL(v),L=document.createElement("a");L.href=k,L.download=`${b}.mp3`,L.click()})},m=()=>{N("saving to Cartier",!0,10,async v=>{const b=s.handle.tracksDir;for(let{blob:q,id:k}of l.memblobs){const L=await b.getFileHandle(`${k}.mp3`,{create:!0});console.info("track handle",L),T(B,i.tracks=[...i.tracks,{id:k,name:l.tracks.find(_=>_.id==k).name,dependants:[]}],i),console.info("trying to create writable"),await Be.write(L,q),console.info("done writing")}T(B,i.playlists=[...i.playlists,{name:o.name,url:o.external_url,desc:o.description,owner:o.owner.display_name,tracks:[...l.tracks.map(q=>q.id)],id:o.id}],i);for(let q of l.tracks)for(let[k,L]of i.tracks.entries())if(L.id==q.id){T(B,i.tracks[k].dependants=[...i.tracks[k].dependants,o.id],i);break}v(),N("saved to Cartier!",!1,2)})},y=async()=>{if(l.detailedLoaded||await g(),!l.tracks)return;if(l.tracks.length==0){N("nothing to download");return}T(c,l.downloading=!0,l),T(c,l.download.stage="converting",l),f.set(0,{duration:1}),f.set(10,{duration:1e4});let v=l.tracks;if(v=v.filter(q=>{let k=!1;for(let L of i.tracks)if(q.id==L.id){k=!0;break}return k&&T(c,l.download.status[q.id]="ready",l),!k}),v.length==0){await f.set(100,{duration:500}),T(c,l.downloading=!1,l),T(c,l.download.done=!0,l);return}let b=v[0];re.getDownloadTrack(b.url,"",!0).then(async q=>{if(q.success==!1){T(f,r=0,r),T(c,l.downloading=!1,l),N(`serverErr: ${q.info}`);return}const k=q.data.key;T(c,l.download.status[b.id]="downloading",l);for(const[_,M]of[...v].splice(1).entries())T(c,l.download.status[M.id]="downloading",l),(await re.getDownloadTrack(M.url,k,!1)).success==!1&&N(`failed downloading track (${M.name})`);await f.set(10);const L=async()=>{let _=await re.getDownloadStatus(k);const M=_.data.filter(x=>x.status!=="downloading");if(_.data.forEach(x=>{T(c,l.download.status[x.id]=x.status,l)}),T(f,r=M.length/_.data.length*40+10,r),M.length==_.data.length){T(c,l.download.stage="downloading",l);for(let x=0;x<M.length;x++){let[S,$,j]=await re.getStreamPlaylist(k);if(!S){N(`failed downloading a track (in "${o.name}")`);continue}T(c,l.memblobs=[...l.memblobs,{blob:$,id:j}],l),T(f,r=(x+1)/M.length*50+50,r)}await f.set(100,{duration:500}),T(c,l.downloading=!1,l),T(c,l.download.done=!0,l);return}setTimeout(L,7500)};setTimeout(L,5e3)})};return t.$$set=v=>{"playlist"in v&&n(0,o=v.playlist),"disabled"in v&&n(1,a=v.disabled)},[o,a,l,r,c,f,d,h,m,y]}class jl extends te{constructor(e){super(),ee(this,e,ql,Cl,J,{playlist:0,disabled:1})}}function pt(t,e,n){const l=t.slice();return l[11]=e[n],l}function gt(t,e,n){const l=t.slice();return l[11]=e[n],l}function Al(t){let e,n,l=le(t[2]||[]),r=[];for(let s=0;s<l.length;s+=1)r[s]=mt(pt(t,l,s));const i=s=>P(r[s],1,1,()=>{r[s]=null});return{c(){for(let s=0;s<r.length;s+=1)r[s].c();e=ve()},m(s,o){for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(s,o);A(s,e,o),n=!0},p(s,o){if(o&6){l=le(s[2]||[]);let a;for(a=0;a<l.length;a+=1){const c=pt(s,l,a);r[a]?(r[a].p(c,o),E(r[a],1)):(r[a]=mt(c),r[a].c(),E(r[a],1),r[a].m(e.parentNode,e))}for(ae(),a=l.length;a<r.length;a+=1)i(a);ce()}},i(s){if(!n){for(let o=0;o<l.length;o+=1)E(r[o]);n=!0}},o(s){r=r.filter(Boolean);for(let o=0;o<r.length;o+=1)P(r[o]);n=!1},d(s){s&&C(e),Ce(r,s)}}}function Ol(t){let e,n,l,r;const i=[El,Tl],s=[];function o(a,c){return!a[3].playlists||a[3].playlists.length==0?0:1}return e=o(t),n=s[e]=i[e](t),{c(){n.c(),l=ve()},m(a,c){s[e].m(a,c),A(a,l,c),r=!0},p(a,c){let f=e;e=o(a),e===f?s[e].p(a,c):(ae(),P(s[f],1,1,()=>{s[f]=null}),ce(),n=s[e],n?n.p(a,c):(n=s[e]=i[e](a),n.c()),E(n,1),n.m(l.parentNode,l))},i(a){r||(E(n),r=!0)},o(a){P(n),r=!1},d(a){a&&C(l),s[e].d(a)}}}function mt(t){let e,n;return e=new jl({props:{playlist:t[11],disabled:t[1].offline}}),{c(){ne(e.$$.fragment)},m(l,r){X(e,l,r),n=!0},p(l,r){const i={};r&4&&(i.playlist=l[11]),r&2&&(i.disabled=l[1].offline),e.$set(i)},i(l){n||(E(e.$$.fragment,l),n=!0)},o(l){P(e.$$.fragment,l),n=!1},d(l){K(e,l)}}}function Tl(t){let e,n,l=le(t[3].playlists||[]),r=[];for(let s=0;s<l.length;s+=1)r[s]=ht(gt(t,l,s));const i=s=>P(r[s],1,1,()=>{r[s]=null});return{c(){for(let s=0;s<r.length;s+=1)r[s].c();e=ve()},m(s,o){for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(s,o);A(s,e,o),n=!0},p(s,o){if(o&8){l=le(s[3].playlists||[]);let a;for(a=0;a<l.length;a+=1){const c=gt(s,l,a);r[a]?(r[a].p(c,o),E(r[a],1)):(r[a]=ht(c),r[a].c(),E(r[a],1),r[a].m(e.parentNode,e))}for(ae(),a=l.length;a<r.length;a+=1)i(a);ce()}},i(s){if(!n){for(let o=0;o<l.length;o+=1)E(r[o]);n=!0}},o(s){r=r.filter(Boolean);for(let o=0;o<r.length;o+=1)P(r[o]);n=!1},d(s){s&&C(e),Ce(r,s)}}}function El(t){let e;return{c(){e=w("p"),e.textContent="Nothing downloaded! ",u(e,"class","pt-10")},m(n,l){A(n,e,l)},p:D,i:D,o:D,d(n){n&&C(e)}}}function ht(t){let e,n;return e=new wl({props:{playlist:t[11]}}),{c(){ne(e.$$.fragment)},m(l,r){X(e,l,r),n=!0},p(l,r){const i={};r&8&&(i.playlist=l[11]),e.$set(i)},i(l){n||(E(e.$$.fragment,l),n=!0)},o(l){P(e.$$.fragment,l),n=!1},d(l){K(e,l)}}}function Pl(t){let e,n,l,r,i,s,o,a,c,f,d,g,h,m,y;const v=[Ol,Al],b=[];function q(k,L){return k[1].view.tab==U.DOWNLOADED?0:1}return c=q(t),f=b[c]=v[c](t),{c(){e=w("div"),n=w("div"),l=w("div"),r=O(),i=w("button"),i.textContent="playlists",s=w("button"),s.textContent="downloaded",o=O(),a=w("div"),f.c(),u(l,"class","bg-border h-full absolute rounded-xl z-10"),u(i,"id","playlistbtn"),u(i,"class","svelte-7mzzq1"),u(s,"id","downloadedbtn"),u(s,"class","svelte-7mzzq1"),u(n,"class","stickytoggle z-10 sticky top-2 w-min flex flex-row items-center justify-between rounded-xl bg-foreground ring-1 ring-border mx-auto svelte-7mzzq1"),u(a,"class","flex flex-col justify-center items-center w-full space-y-2 pb-[11vh] relative"),u(e,"class","h-[82vh] overflow-y-scroll w-[100vw]"),u(e,"style",g=t[1].view.tab in[U.PLAYLISTS,U.DOWNLOADED]?"":"display: none")},m(k,L){A(k,e,L),p(e,n),p(n,l),t[4](l),p(n,r),p(n,i),p(n,s),p(e,o),p(e,a),b[c].m(a,null),h=!0,m||(y=[H(i,"click",t[5]),H(s,"click",t[6])],m=!0)},p(k,[L]){let _=c;c=q(k),c===_?b[c].p(k,L):(ae(),P(b[_],1,1,()=>{b[_]=null}),ce(),f=b[c],f?f.p(k,L):(f=b[c]=v[c](k),f.c()),E(f,1),f.m(a,null)),(!h||L&2&&g!==(g=k[1].view.tab in[U.PLAYLISTS,U.DOWNLOADED]?"":"display: none"))&&u(e,"style",g)},i(k){h||(E(f),k&&(d||se(()=>{d=Jt(a,Se,{duration:1e3}),d.start()})),h=!0)},o(k){P(f),h=!1},d(k){k&&C(e),t[4](null),b[c].d(),m=!1,G(y)}}}function Dl(t,e,n){let l,r;W(t,dl,h=>n(7,h)),W(t,z,h=>n(1,l=h)),W(t,B,h=>n(3,r=h));let i,s={left:Ee(0,{duration:50,easing:Xe}),width:Ee(0,{duration:50,easing:Xe})},o=[];Le(()=>{if(!r.playlists){n(2,o=l.playlists.all);return}n(2,o=l.playlists.all.filter(h=>{let m=!1;for(let y of r.playlists)if(y.id==h.id){m=!0;break}return!m}))}),s.left.subscribe(h=>{i&&n(0,i.style.left=`${h}px`,i)}),s.width.subscribe(h=>{i&&n(0,i.style.width=`${h}px`,i)}),Le(()=>{});function f(h){Me[h?"unshift":"push"](()=>{i=h,n(0,i)})}const d=()=>T(z,l.view.tab=U.PLAYLISTS,l),g=()=>T(z,l.view.tab=U.DOWNLOADED,l);return t.$$.update=()=>{if(t.$$.dirty&3&&i)switch(l.view.tab){case U.PLAYLISTS:s.left.set(0),s.width.set(document.getElementById("playlistbtn").clientWidth);break;case U.DOWNLOADED:s.left.set(document.getElementById("playlistbtn").clientWidth),s.width.set(document.getElementById("downloadedbtn").clientWidth);break}},[i,l,o,r,f,d,g]}class Hl extends te{constructor(e){super(),ee(this,e,Dl,Pl,J,{})}}function wt(t){let e,n,l,r,i,s,o,a,c;function f(h,m){return h[0].user.images&&h[0].user.images.length>0?Nl:Fl}let d=f(t),g=d(t);return{c(){e=w("div"),n=w("button"),n.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-[3em]"><path d="M11.47 3.841a.75.75 0 0 1 1.06 0l8.69 8.69a.75.75 0 1 0 1.06-1.061l-8.689-8.69a2.25 2.25 0 0 0-3.182 0l-8.69 8.69a.75.75 0 1 0 1.061 1.06l8.69-8.689Z"></path><path d="m12 5.432 8.159 8.159c.03.03.06.058.091.086v6.198c0 1.035-.84 1.875-1.875 1.875H15a.75.75 0 0 1-.75-.75v-4.5a.75.75 0 0 0-.75-.75h-3a.75.75 0 0 0-.75.75V21a.75.75 0 0 1-.75.75H5.625a1.875 1.875 0 0 1-1.875-1.875v-6.198a2.29 2.29 0 0 0 .091-.086L12 5.432Z"></path></svg>
      home`,l=O(),r=w("button"),g.c(),i=F(`
      account`),s=O(),o=w("button"),o.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-[3em]"><path fill-rule="evenodd" d="M11.078 2.25c-.917 0-1.699.663-1.85 1.567L9.05 4.889c-.02.12-.115.26-.297.348a7.493 7.493 0 0 0-.986.57c-.166.115-.334.126-.45.083L6.3 5.508a1.875 1.875 0 0 0-2.282.819l-.922 1.597a1.875 1.875 0 0 0 .432 2.385l.84.692c.095.078.17.229.154.43a7.598 7.598 0 0 0 0 1.139c.015.2-.059.352-.153.43l-.841.692a1.875 1.875 0 0 0-.432 2.385l.922 1.597a1.875 1.875 0 0 0 2.282.818l1.019-.382c.115-.043.283-.031.45.082.312.214.641.405.985.57.182.088.277.228.297.35l.178 1.071c.151.904.933 1.567 1.85 1.567h1.844c.916 0 1.699-.663 1.85-1.567l.178-1.072c.02-.12.114-.26.297-.349.344-.165.673-.356.985-.57.167-.114.335-.125.45-.082l1.02.382a1.875 1.875 0 0 0 2.28-.819l.923-1.597a1.875 1.875 0 0 0-.432-2.385l-.84-.692c-.095-.078-.17-.229-.154-.43a7.614 7.614 0 0 0 0-1.139c-.016-.2.059-.352.153-.43l.84-.692c.708-.582.891-1.59.433-2.385l-.922-1.597a1.875 1.875 0 0 0-2.282-.818l-1.02.382c-.114.043-.282.031-.449-.083a7.49 7.49 0 0 0-.985-.57c-.183-.087-.277-.227-.297-.348l-.179-1.072a1.875 1.875 0 0 0-1.85-1.567h-1.843ZM12 15.75a3.75 3.75 0 1 0 0-7.5 3.75 3.75 0 0 0 0 7.5Z" clip-rule="evenodd"></path></svg>
      settings`,u(n,"class","flex flex-col items-center justify-center bg-transparent text-white text-xs svelte-gbqgsd"),u(r,"class","flex flex-col items-center justify-center bg-transparent text-white text-xs svelte-gbqgsd"),u(o,"class","flex flex-col items-center justify-center bg-transparent text-white text-xs svelte-gbqgsd"),u(e,"class","container flex flex-row justify-around items-center h-[11vh] bg-gradient-to-t from-background to-border w-[95vw] rounded-b-xl ring-1 ring-border py-5 svelte-gbqgsd")},m(h,m){A(h,e,m),p(e,n),p(e,l),p(e,r),g.m(r,null),p(r,i),p(e,s),p(e,o),a||(c=[H(n,"click",t[1]),H(r,"click",t[2]),H(o,"click",t[3])],a=!0)},p(h,m){d===(d=f(h))&&g?g.p(h,m):(g.d(1),g=d(h),g&&(g.c(),g.m(r,i)))},d(h){h&&C(e),g.d(),a=!1,G(c)}}}function Fl(t){let e;return{c(){e=F("open")},m(n,l){A(n,e,l)},p:D,d(n){n&&C(e)}}}function Nl(t){let e,n,l;return{c(){e=w("img"),u(e,"loading","lazy"),we(e.src,n=t[0].user.images[0].url)||u(e,"src",n),u(e,"alt",l=`${t[0].user.display_name}'s profile picture`),u(e,"class","rounded-full w-[4em] ring-border ring-1 aspect-square")},m(r,i){A(r,e,i)},p(r,i){i&1&&!we(e.src,n=r[0].user.images[0].url)&&u(e,"src",n),i&1&&l!==(l=`${r[0].user.display_name}'s profile picture`)&&u(e,"alt",l)},d(r){r&&C(e)}}}function Zl(t){let e,n=t[0].logged&&wt(t);return{c(){n&&n.c(),e=ve()},m(l,r){n&&n.m(l,r),A(l,e,r)},p(l,[r]){l[0].logged?n?n.p(l,r):(n=wt(l),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:D,o:D,d(l){l&&C(e),n&&n.d(l)}}}function Il(t,e,n){let l;return W(t,z,o=>n(0,l=o)),[l,()=>{T(z,l.view.tab=U.PLAYLISTS,l)},()=>{T(z,l.view.tab=U.ACCOUNT,l)},()=>{T(z,l.view.tab=U.SETTINGS,l)}]}class Bl extends te{constructor(e){super(),ee(this,e,Il,Zl,J,{})}}function bt(t){let e,n;return e=new gl({}),{c(){ne(e.$$.fragment)},m(l,r){X(e,l,r),n=!0},i(l){n||(E(e.$$.fragment,l),n=!0)},o(l){P(e.$$.fragment,l),n=!1},d(l){K(e,l)}}}function Ul(t){let e,n,l;return{c(){e=w("button"),e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path fill-rule="evenodd" d="M4.5 5.653c0-1.427 1.529-2.33 2.779-1.643l11.54 6.347c1.295.712 1.295 2.573 0 3.286L7.28 19.99c-1.25.687-2.779-.217-2.779-1.643V5.653Z" clip-rule="evenodd"></path></svg>',u(e,"class","col-span-1 svg-icon svelte-1vi17k2")},m(r,i){A(r,e,i),n||(l=H(e,"click",R.resume),n=!0)},d(r){r&&C(e),n=!1,l()}}}function Wl(t){let e,n,l;return{c(){e=w("button"),e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path fill-rule="evenodd" d="M6.75 5.25a.75.75 0 0 1 .75-.75H9a.75.75 0 0 1 .75.75v13.5a.75.75 0 0 1-.75.75H7.5a.75.75 0 0 1-.75-.75V5.25Zm7.5 0A.75.75 0 0 1 15 4.5h1.5a.75.75 0 0 1 .75.75v13.5a.75.75 0 0 1-.75.75H15a.75.75 0 0 1-.75-.75V5.25Z" clip-rule="evenodd"></path></svg>',u(e,"class","col-span-1 svg-icon svelte-1vi17k2")},m(r,i){A(r,e,i),n||(l=H(e,"click",R.pause),n=!0)},d(r){r&&C(e),n=!1,l()}}}function zl(t){let e,n,l,r,i,s,o,a=t[0].playback.name+"",c,f,d,g,h,m,y,v,b,q,k,L;n=new Hl({});let _=t[1].view.tab==U.SETTINGS&&bt();function M($,j){return $[0].playback.playing?Wl:Ul}let x=M(t),S=x(t);return b=new Bl({}),{c(){e=w("div"),ne(n.$$.fragment),l=O(),_&&_.c(),r=O(),i=w("div"),s=w("div"),o=w("p"),c=F(a),f=O(),S.c(),d=O(),g=w("button"),g.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path fill-rule="evenodd" d="M13.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L11.69 12 4.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path><path fill-rule="evenodd" d="M19.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 1 1-1.06-1.06L17.69 12l-6.97-6.97a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg>',h=O(),m=w("div"),v=O(),ne(b.$$.fragment),u(o,"class","truncate col-span-8"),u(g,"class","col-span-1 svg-icon svelte-1vi17k2"),u(s,"class","bg-foreground rounded-t-md w-full h-full grid grid-cols-10 items-center justify-center gap-1"),u(m,"class","bottom-0 h-[2px] bg-primary"),$e(m,"width",t[0].playback.time/t[0].playback.dur*100+"%"),u(i,"style",y=t[0].loaded?"":"visibility: hidden"),u(i,"class","ring-1 ring-border rounded-t-md w-[95%] h-[10vh] absolute bottom-[11vh]"),u(e,"class","flex flex-col items-center justify-center relative")},m($,j){A($,e,j),X(n,e,null),p(e,l),_&&_.m(e,null),p(e,r),p(e,i),p(i,s),p(s,o),p(o,c),p(s,f),S.m(s,null),p(s,d),p(s,g),p(i,h),p(i,m),p(e,v),X(b,e,null),q=!0,k||(L=H(g,"click",t[2]),k=!0)},p($,[j]){$[1].view.tab==U.SETTINGS?_?j&2&&E(_,1):(_=bt(),_.c(),E(_,1),_.m(e,r)):_&&(ae(),P(_,1,1,()=>{_=null}),ce()),(!q||j&1)&&a!==(a=$[0].playback.name+"")&&Q(c,a),x!==(x=M($))&&(S.d(1),S=x($),S&&(S.c(),S.m(s,d))),(!q||j&1)&&$e(m,"width",$[0].playback.time/$[0].playback.dur*100+"%"),(!q||j&1&&y!==(y=$[0].loaded?"":"visibility: hidden"))&&u(i,"style",y)},i($){q||(E(n.$$.fragment,$),E(_),E(b.$$.fragment,$),q=!0)},o($){P(n.$$.fragment,$),P(_),P(b.$$.fragment,$),q=!1},d($){$&&C(e),K(n),_&&_.d(),S.d(),K(b),k=!1,L()}}}function Vl(t,e,n){let l,r;W(t,V,o=>n(0,l=o)),W(t,z,o=>n(1,r=o));let i=Ee(0,{duration:1e3});const s=()=>{R.next()==!1?N("queue is empty"):R.play()};return t.$$.update=()=>{t.$$.dirty&1&&i.set(l.playback.time/l.playback.dur*100)},[l,r,s]}class Rl extends te{constructor(e){super(),ee(this,e,Vl,zl,J,{})}}function Yl(t){let e,n;const l=t[1].default,r=yt(l,t,t[0],null);return{c(){e=w("div"),r&&r.c(),u(e,"class","max-h-[90%] max-w-[90%]")},m(i,s){A(i,e,s),r&&r.m(e,null),n=!0},p(i,[s]){r&&r.p&&(!n||s&1)&&xt(r,l,i,i[0],n?$t(l,i[0],s,null):Lt(i[0]),null)},i(i){n||(E(r,i),n=!0)},o(i){P(r,i),n=!1},d(i){i&&C(e),r&&r.d(i)}}}function Gl(t,e,n){let{$$slots:l={},$$scope:r}=e;return t.$$set=i=>{"$$scope"in i&&n(0,r=i.$$scope)},[r,l]}class Jl extends te{constructor(e){super(),ee(this,e,Gl,Yl,J,{})}}function Ql(t){let e,n;return e=new sl({props:{handleWakeup:t[2]}}),{c(){ne(e.$$.fragment)},m(l,r){X(e,l,r),n=!0},p:D,i(l){n||(E(e.$$.fragment,l),n=!0)},o(l){P(e.$$.fragment,l),n=!1},d(l){K(e,l)}}}function Xl(t){let e,n;return e=new Rl({}),{c(){ne(e.$$.fragment)},m(l,r){X(e,l,r),n=!0},p:D,i(l){n||(E(e.$$.fragment,l),n=!0)},o(l){P(e.$$.fragment,l),n=!1},d(l){K(e,l)}}}function Kl(t){let e,n;return e=new Jl({props:{$$slots:{default:[en]},$$scope:{ctx:t}}}),{c(){ne(e.$$.fragment)},m(l,r){X(e,l,r),n=!0},p(l,r){const i={};r&32&&(i.$$scope={dirty:r,ctx:l}),e.$set(i)},i(l){n||(E(e.$$.fragment,l),n=!0)},o(l){P(e.$$.fragment,l),n=!1},d(l){K(e,l)}}}function en(t){let e,n;return e=new cl({props:{handleUserid:t[1]}}),{c(){ne(e.$$.fragment)},m(l,r){X(e,l,r),n=!0},p:D,i(l){n||(E(e.$$.fragment,l),n=!0)},o(l){P(e.$$.fragment,l),n=!1},d(l){K(e,l)}}}function tn(t){let e,n,l,r,i,s,o,a,c,f;const d=[Kl,Xl,Ql],g=[];function h(m,y){return!m[0].logged&&!m[0].offline?0:m[0].logged?1:2}return i=h(t),s=g[i]=d[i](t),{c(){e=w("div"),n=O(),l=w("main"),r=w("div"),s.c(),o=O(),a=w("div"),u(e,"class","bg-foreground/90 p-1 rounded-md w-[80vw] max-w-[90vw] z-[1000]"),$e(e,"display","none"),u(a,"class","absolute left-0 top-[1em] w-full flex flex-col items-center justify-center space-y-1 text-xs"),u(r,"class","flex flex-col justify-center items-center relative h-[100%] bg-background"),u(l,"class","w-screen h-screen text-white text-xl select-none text-center")},m(m,y){A(m,e,y),t[3](e),A(m,n,y),A(m,l,y),p(l,r),g[i].m(r,null),p(r,o),p(r,a),t[4](a),f=!0},p(m,[y]){let v=i;i=h(m),i===v?g[i].p(m,y):(ae(),P(g[v],1,1,()=>{g[v]=null}),ce(),s=g[i],s?s.p(m,y):(s=g[i]=d[i](m),s.c()),E(s,1),s.m(r,o))},i(m){f||(E(s),m&&se(()=>{f&&(c||(c=be(a,Se,{duration:1e4},!0)),c.run(1))}),f=!0)},o(m){P(s),m&&(c||(c=be(a,Se,{duration:1e4},!1)),c.run(0)),f=!1},d(m){m&&(C(e),C(n),C(l)),t[3](null),g[i].d(),t[4](null),m&&c&&c.end()}}}let Ae,Tt;const N=(t,e=!1,n=3,l)=>{const r=Tt.cloneNode(!0);r.innerHTML=e?`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-[1.2em] animate-spin inline aspect-square mr-1" > <path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99" /> </svg>${t}`:t,r.style.display="block",Ae.appendChild(r),l?l(()=>Ae.removeChild(r)):setTimeout(()=>Ae.removeChild(r),n*1e3)};function ln(t,e,n){let l;W(t,z,a=>n(0,l=a));const r=async a=>{await oe.login(a)},i=a=>{a?T(z,l.offline=!1,l):N("Cartier is running offline",!1,5),oe.init()};function s(a){Me[a?"unshift":"push"](()=>{Tt=a})}function o(a){Me[a?"unshift":"push"](()=>{Ae=a})}return[l,r,i,s,o]}class nn extends te{constructor(e){super(),ee(this,e,ln,tn,J,{})}}new nn({target:document.getElementById("app")});
