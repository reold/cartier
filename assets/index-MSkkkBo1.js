var at=Object.defineProperty;var ct=(t,e,n)=>e in t?at(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Ae=(t,e,n)=>(ct(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const i of l)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(l){const i={};return l.integrity&&(i.integrity=l.integrity),l.referrerPolicy&&(i.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?i.credentials="include":l.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(l){if(l.ep)return;l.ep=!0;const i=n(l);fetch(l.href,i)}})();function T(){}const ut=t=>t;function Ee(t,e){for(const n in e)t[n]=e[n];return t}function Ge(t){return t()}function Ue(){return Object.create(null)}function se(t){t.forEach(Ge)}function Je(t){return typeof t=="function"}function ie(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let $e;function pe(t,e){return t===e?!0:($e||($e=document.createElement("a")),$e.href=e,t===$e.href)}function ft(t){return Object.keys(t).length===0}function dt(t,...e){if(t==null){for(const r of e)r(void 0);return T}const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function Le(t,e,n){t.$$.on_destroy.push(dt(e,n))}function pt(t,e,n,r){if(t){const l=Qe(t,e,n,r);return t[0](l)}}function Qe(t,e,n,r){return t[1]&&r?Ee(n.ctx.slice(),t[1](r(e))):n.ctx}function gt(t,e,n,r){if(t[2]&&r){const l=t[2](r(n));if(e.dirty===void 0)return l;if(typeof l=="object"){const i=[],a=Math.max(e.dirty.length,l.length);for(let u=0;u<a;u+=1)i[u]=e.dirty[u]|l[u];return i}return e.dirty|l}return e.dirty}function ht(t,e,n,r,l,i){if(l){const a=Qe(e,n,r,i);t.p(a,l)}}function mt(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let r=0;r<n;r++)e[r]=-1;return e}return-1}function Q(t,e,n){return t.set(n),e}const Xe=typeof window<"u";let wt=Xe?()=>window.performance.now():()=>Date.now(),Ye=Xe?t=>requestAnimationFrame(t):T;const fe=new Set;function et(t){fe.forEach(e=>{e.c(t)||(fe.delete(e),e.f())}),fe.size!==0&&Ye(et)}function _t(t){let e;return fe.size===0&&Ye(et),{promise:new Promise(n=>{fe.add(e={c:t,f:n})}),abort(){fe.delete(e)}}}function c(t,e){t.appendChild(e)}function $(t,e,n){t.insertBefore(e,n||null)}function y(t){t.parentNode&&t.parentNode.removeChild(t)}function tt(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function p(t){return document.createElement(t)}function V(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function U(t){return document.createTextNode(t)}function C(){return U(" ")}function nt(){return U("")}function ee(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function s(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function bt(t){return Array.from(t.childNodes)}function te(t,e){e=""+e,t.data!==e&&(t.data=e)}function Te(t,e){t.value=e??""}function ge(t,e,n,r){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,r?"important":"")}function qe(t,e,n){t.classList.toggle(e,!!n)}let ke;function be(t){ke=t}function vt(){if(!ke)throw new Error("Function called outside component initialization");return ke}function rt(t){vt().$$.on_mount.push(t)}const ue=[],Ce=[];let de=[];const De=[],kt=Promise.resolve();let Pe=!1;function yt(){Pe||(Pe=!0,kt.then(lt))}function Se(t){de.push(t)}const Ie=new Set;let ae=0;function lt(){if(ae!==0)return;const t=ke;do{try{for(;ae<ue.length;){const e=ue[ae];ae++,be(e),xt(e.$$)}}catch(e){throw ue.length=0,ae=0,e}for(be(null),ue.length=0,ae=0;Ce.length;)Ce.pop()();for(let e=0;e<de.length;e+=1){const n=de[e];Ie.has(n)||(Ie.add(n),n())}de.length=0}while(ue.length);for(;De.length;)De.pop()();Pe=!1,Ie.clear(),be(t)}function xt(t){if(t.fragment!==null){t.update(),se(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Se)}}function $t(t){const e=[],n=[];de.forEach(r=>t.indexOf(r)===-1?e.push(r):n.push(r)),n.forEach(r=>r()),de=e}const je=new Set;let le;function st(){le={r:0,c:[],p:le}}function it(){le.r||se(le.c),le=le.p}function Z(t,e){t&&t.i&&(je.delete(t),t.i(e))}function X(t,e,n,r){if(t&&t.o){if(je.has(t))return;je.add(t),le.c.push(()=>{je.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}function Me(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function ye(t){t&&t.c()}function he(t,e,n){const{fragment:r,after_update:l}=t.$$;r&&r.m(e,n),Se(()=>{const i=t.$$.on_mount.map(Ge).filter(Je);t.$$.on_destroy?t.$$.on_destroy.push(...i):se(i),t.$$.on_mount=[]}),l.forEach(Se)}function me(t,e){const n=t.$$;n.fragment!==null&&($t(n.after_update),se(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function jt(t,e){t.$$.dirty[0]===-1&&(ue.push(t),yt(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function we(t,e,n,r,l,i,a=null,u=[-1]){const f=ke;be(t);const o=t.$$={fragment:null,ctx:[],props:i,update:T,not_equal:l,bound:Ue(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(f?f.$$.context:[])),callbacks:Ue(),dirty:u,skip_bound:!1,root:e.target||f.$$.root};a&&a(o.root);let d=!1;if(o.ctx=n?n(t,e.props||{},(g,h,...w)=>{const m=w.length?w[0]:h;return o.ctx&&l(o.ctx[g],o.ctx[g]=m)&&(!o.skip_bound&&o.bound[g]&&o.bound[g](m),d&&jt(t,g)),h}):[],o.update(),d=!0,se(o.before_update),o.fragment=r?r(o.ctx):!1,e.target){if(e.hydrate){const g=bt(e.target);o.fragment&&o.fragment.l(g),g.forEach(y)}else o.fragment&&o.fragment.c();e.intro&&Z(t.$$.fragment),he(t,e.target,e.anchor),lt()}be(f)}class _e{constructor(){Ae(this,"$$");Ae(this,"$$set")}$destroy(){me(this,1),this.$destroy=T}$on(e,n){if(!Je(n))return T;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const l=r.indexOf(n);l!==-1&&r.splice(l,1)}}$set(e){this.$$set&&!ft(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Ct="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Ct);window["cartier-server-url"]="https://reold-cartier.glitch.me";const re={getRoot:async()=>await(await fetch(`${window["cartier-server-url"]}/`)).json(),getUserInfo:async t=>await(await fetch(`${window["cartier-server-url"]}/user?username=${t}`)).json(),getPlaylistInfo:async t=>await(await fetch(`${window["cartier-server-url"]}/playlist?id=${t}`)).json(),getDownloadPlaylist:async t=>await(await fetch(`${window["cartier-server-url"]}/download?link=${t}`)).json(),getDownloadStatus:async t=>await(await fetch(`${window["cartier-server-url"]}/status?key=${t}`)).json(),getDownloadTrack:async(t,e="",n=!1)=>await(await fetch(`${window["cartier-server-url"]}/track?link=${t}&key=${e}&create=${n}`)).json(),getStreamPlaylist:async t=>{let e=await fetch(`${window["cartier-server-url"]}/stream?key=${t}`);return[await e.ok,await e.blob()]}},ce=[];function Be(t,e=T){let n;const r=new Set;function l(u){if(ie(t,u)&&(t=u,n)){const f=!ce.length;for(const o of r)o[1](),ce.push(o,t);if(f){for(let o=0;o<ce.length;o+=2)ce[o][0](ce[o+1]);ce.length=0}}}function i(u){l(u(t))}function a(u,f=T){const o=[u,f];return r.add(o),r.size===1&&(n=e(l,i)||T),u(t),()=>{r.delete(o),r.size===0&&n&&(n(),n=null)}}return{set:l,update:i,subscribe:a}}function Mt(t){let e,n,r;const l=t[2].default,i=pt(l,t,t[1],null);return{c(){e=p("div"),n=p("div"),i&&i.c(),s(n,"class","bg-gray-950 p-2 rounded-md ring-1 ring-zinc-500 max-w-[90vw]"),s(e,"class","absolute top-0 left-0 w-full h-full backdrop-blur-md flex flex-col items-center justify-center text-center text-xs"),ge(e,"visibility",t[0]?"hidden":"visible")},m(a,u){$(a,e,u),c(e,n),i&&i.m(n,null),r=!0},p(a,[u]){i&&i.p&&(!r||u&2)&&ht(i,l,a,a[1],r?gt(l,a[1],u,null):mt(a[1]),null),(!r||u&1)&&ge(e,"visibility",a[0]?"hidden":"visible")},i(a){r||(Z(i,a),r=!0)},o(a){X(i,a),r=!1},d(a){a&&y(e),i&&i.d(a)}}}function Lt(t,e,n){let{$$slots:r={},$$scope:l}=e,{hidden:i=!1}=e;return t.$$set=a=>{"hidden"in a&&n(0,i=a.hidden),"$$scope"in a&&n(1,l=a.$$scope)},[i,l,r]}class At extends _e{constructor(e){super(),we(this,e,Lt,Mt,ie,{hidden:0})}}function He(t){let e,n;return{c(){e=V("svg"),n=V("path"),s(n,"stroke-linecap","round"),s(n,"stroke-linejoin","round"),s(n,"d","M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"),s(e,"xmlns","http://www.w3.org/2000/svg"),s(e,"fill","none"),s(e,"viewBox","0 0 24 24"),s(e,"stroke-width","1.5"),s(e,"stroke","currentColor"),s(e,"class","aspect-square w-[1.2em] animate-spin inline")},m(r,l){$(r,e,l),c(e,n)},d(r){r&&y(e)}}}function It(t){let e,n,r,l,i,a,u=t[0].step+"",f,o=t[0].is&&He();return{c(){e=p("h1"),e.textContent="Waking up servers!",n=C(),r=p("p"),r.textContent=`Our servers take a little break every 5 minutes when things quiet down.
    We're in the process of waking them up for you. It's automatic, so no need
    to stress!`,l=C(),i=p("p"),o&&o.c(),a=C(),f=U(u),s(e,"class","text-xl"),s(r,"class","text-xs text-gray-500 inline"),s(i,"class","inline"),qe(i,"text-green-500",!t[0].is)},m(d,g){$(d,e,g),$(d,n,g),$(d,r,g),$(d,l,g),$(d,i,g),o&&o.m(i,null),c(i,a),c(i,f)},p(d,g){d[0].is?o||(o=He(),o.c(),o.m(i,a)):o&&(o.d(1),o=null),g&1&&u!==(u=d[0].step+"")&&te(f,u),g&1&&qe(i,"text-green-500",!d[0].is)},d(d){d&&(y(e),y(n),y(r),y(l),y(i)),o&&o.d()}}}function Et(t){let e,n;return e=new At({props:{hidden:!t[0].is,$$slots:{default:[It]},$$scope:{ctx:t}}}),{c(){ye(e.$$.fragment)},m(r,l){he(e,r,l),n=!0},p(r,[l]){const i={};l&1&&(i.hidden=!r[0].is),l&5&&(i.$$scope={dirty:l,ctx:r}),e.$set(i)},i(r){n||(Z(e.$$.fragment,r),n=!0)},o(r){X(e.$$.fragment,r),n=!1},d(r){me(e,r)}}}function Pt(t,e,n){let r;const l=Be({step:"trying to make contact",is:!0});return Le(t,l,i=>n(0,r=i)),rt(()=>{Q(l,r.step="waking up servers",r),re.getRoot().then(i=>{Q(l,r.is=!1,r),Q(l,r.step="servers are running!",r)}).catch(i=>{J(`unable to reach servers. err: ${i}`),Q(l,r.step="servers unreachable (reload?)",r)})}),[r,l]}class St extends _e{constructor(e){super(),we(this,e,Pt,Et,ie,{})}}function Ot(t){let e,n,r,l,i,a,u,f,o,d,g,h,w,m,x,E,L,S,A,P,O,z,H;return e=new St({}),{c(){ye(e.$$.fragment),n=C(),r=p("div"),l=p("p"),l.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 inline"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244"></path></svg>
    fill-in to continue`,i=C(),a=p("div"),u=p("div"),f=p("input"),o=C(),d=p("button"),d.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 inline rounded-full"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"></path></svg>',g=C(),h=p("p"),h.textContent="copy your profile link from your spotify account page",w=C(),m=p("div"),x=p("label"),E=p("input"),L=C(),S=p("span"),S.textContent="persist",A=C(),P=p("button"),P.textContent="continue",s(l,"class","text-2xl"),s(f,"type","text"),s(f,"class","w-full"),s(f,"placeholder","spotify profile link"),s(f,"autocomplete","url"),s(f,"aria-label","spotify profile link"),s(d,"class","bg-zinc-500"),s(d,"aria-label","paste from clipboard"),s(u,"class","w-full flex flex-row items-center justify-center space-x-2"),s(h,"class","text-sm"),s(a,"class","flex flex-col items-center justify-center"),s(E,"type","checkbox"),s(E,"class","inline"),s(S,"class","align-middle"),s(x,"for","persisting userid"),s(x,"class","text-base flex flex-row space-x-2 bg-gray-950 p-3 rounded-md"),s(P,"class","hover:scale-110"),s(m,"class","flex flex-row items-center justify-center space-x-3"),s(r,"class","flex flex-col items-center text-center justify-center bg-aodFg ring-1 ring-zinc-500 rounded-md w-11/12 py-5 space-y-7 px-5")},m(_,B){he(e,_,B),$(_,n,B),$(_,r,B),c(r,l),c(r,i),c(r,a),c(a,u),c(u,f),Te(f,t[0]),c(u,o),c(u,d),c(a,g),c(a,h),c(r,w),c(r,m),c(m,x),c(x,E),E.checked=t[1],c(x,L),c(x,S),c(m,A),c(m,P),O=!0,z||(H=[ee(f,"input",t[5]),ee(d,"click",t[2]),ee(E,"change",t[6]),ee(P,"click",t[3])],z=!0)},p(_,[B]){B&1&&f.value!==_[0]&&Te(f,_[0]),B&2&&(E.checked=_[1])},i(_){O||(Z(e.$$.fragment,_),O=!0)},o(_){X(e.$$.fragment,_),O=!1},d(_){_&&(y(n),y(r)),me(e,_),z=!1,se(H)}}}function zt(t,e,n){rt(()=>{const d=localStorage.getItem("cartier-userid");d&&(J("performing auto-login",!0),r(d))});let{handleUsername:r}=e,l="",i=!0;const a=async()=>{navigator.clipboard.readText&&n(0,l=await navigator.clipboard.readText())},u=()=>{let d;try{d=new URL(l)}catch{n(0,l="");return}const g=d.pathname.split("/")[2];i&&(localStorage.setItem("cartier-userid",g),J("login information saved!")),r(g)};function f(){l=this.value,n(0,l)}function o(){i=this.checked,n(1,i)}return t.$$set=d=>{"handleUsername"in d&&n(4,r=d.handleUsername)},[l,i,a,u,r,f,o]}class Bt extends _e{constructor(e){super(),we(this,e,zt,Ot,ie,{handleUsername:4})}}function Ne(t){return Object.prototype.toString.call(t)==="[object Date]"}function Ut(t){return t<.5?4*t*t*t:.5*Math.pow(2*t-2,3)+1}function Oe(t,e){if(t===e||t!==t)return()=>t;const n=typeof t;if(n!==typeof e||Array.isArray(t)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(t)){const r=e.map((l,i)=>Oe(t[i],l));return l=>r.map(i=>i(l))}if(n==="object"){if(!t||!e)throw new Error("Object cannot be null");if(Ne(t)&&Ne(e)){t=t.getTime(),e=e.getTime();const i=e-t;return a=>new Date(t+a*i)}const r=Object.keys(e),l={};return r.forEach(i=>{l[i]=Oe(t[i],e[i])}),i=>{const a={};return r.forEach(u=>{a[u]=l[u](i)}),a}}if(n==="number"){const r=e-t;return l=>t+l*r}throw new Error(`Cannot interpolate ${n} values`)}function Tt(t,e={}){const n=Be(t);let r,l=t;function i(a,u){if(t==null)return n.set(t=a),Promise.resolve();l=a;let f=r,o=!1,{delay:d=0,duration:g=400,easing:h=ut,interpolate:w=Oe}=Ee(Ee({},e),u);if(g===0)return f&&(f.abort(),f=null),n.set(t=l),Promise.resolve();const m=wt()+d;let x;return r=_t(E=>{if(E<m)return!0;o||(x=w(t,a),typeof g=="function"&&(g=g(t,a)),o=!0),f&&(f.abort(),f=null);const L=E-m;return L>g?(n.set(t=a),!1):(n.set(t=x(h(L/g))),!0)}),r.promise}return{set:i,update:(a,u)=>i(a(l,t),u),subscribe:n.subscribe}}function Re(t,e,n){const r=t.slice();return r[0]=e[n],r}function qt(t){let e,n;return{c(){e=V("svg"),n=V("path"),s(n,"stroke-linecap","round"),s(n,"stroke-linejoin","round"),s(n,"d","M18.364 18.364A9 9 0 0 0 5.636 5.636m12.728 12.728A9 9 0 0 1 5.636 5.636m12.728 12.728L5.636 5.636"),s(e,"xmlns","http://www.w3.org/2000/svg"),s(e,"fill","none"),s(e,"viewBox","0 0 24 24"),s(e,"stroke-width","1.5"),s(e,"stroke","currentColor"),s(e,"class","w-[10vh] h-[10vh]")},m(r,l){$(r,e,l),c(e,n)},p:T,d(r){r&&y(e)}}}function Dt(t){let e,n;return{c(){e=p("img"),s(e,"loading","lazy"),pe(e.src,n=t[0].images[0].url)||s(e,"src",n),s(e,"class","rounded-full max-h-[10vh] shadow-black shadow-lg ring-1 ring-black"),s(e,"alt","playlist's cover")},m(r,l){$(r,e,l)},p(r,l){l&1&&!pe(e.src,n=r[0].images[0].url)&&s(e,"src",n)},d(r){r&&y(e)}}}function Ht(t){let e,n;return{c(){e=V("svg"),n=V("path"),s(n,"stroke-linecap","round"),s(n,"stroke-linejoin","round"),s(n,"d","m19.5 8.25-7.5 7.5-7.5-7.5"),s(e,"xmlns","http://www.w3.org/2000/svg"),s(e,"fill","none"),s(e,"viewBox","0 0 24 24"),s(e,"stroke-width","4"),s(e,"stroke","currentColor"),s(e,"class","w-[1.2em] text-xs aspect-square")},m(r,l){$(r,e,l),c(e,n)},d(r){r&&y(e)}}}function Nt(t){let e,n;return{c(){e=V("svg"),n=V("path"),s(n,"stroke-linecap","round"),s(n,"stroke-linejoin","round"),s(n,"d","m4.5 15.75 7.5-7.5 7.5 7.5"),s(e,"xmlns","http://www.w3.org/2000/svg"),s(e,"fill","none"),s(e,"viewBox","0 0 24 24"),s(e,"stroke-width","3"),s(e,"stroke","currentColor"),s(e,"class","w-[1.2em] aspect-square text-xs")},m(r,l){$(r,e,l),c(e,n)},d(r){r&&y(e)}}}function Rt(t){let e;return{c(){e=U("download")},m(n,r){$(n,e,r)},p:T,d(n){n&&y(e)}}}function Vt(t){let e;return{c(){e=U("downloaded")},m(n,r){$(n,e,r)},p:T,d(n){n&&y(e)}}}function Ft(t){let e,n,r,l;function i(f,o){return f[3].stage=="downloading"?Zt:Wt}let a=i(t),u=a(t);return{c(){e=V("svg"),n=V("path"),r=C(),u.c(),l=nt(),s(n,"stroke-linecap","round"),s(n,"stroke-linejoin","round"),s(n,"d","M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"),s(e,"xmlns","http://www.w3.org/2000/svg"),s(e,"fill","none"),s(e,"viewBox","0 0 24 24"),s(e,"stroke-width","1.5"),s(e,"stroke","currentColor"),s(e,"class","w-4 h-4 inline animate-spin")},m(f,o){$(f,e,o),c(e,n),$(f,r,o),u.m(f,o),$(f,l,o)},p(f,o){a!==(a=i(f))&&(u.d(1),u=a(f),u&&(u.c(),u.m(l.parentNode,l)))},d(f){f&&(y(e),y(r),y(l)),u.d(f)}}}function Wt(t){let e;return{c(){e=U("converting")},m(n,r){$(n,e,r)},d(n){n&&y(e)}}}function Zt(t){let e;return{c(){e=U("downloading")},m(n,r){$(n,e,r)},d(n){n&&y(e)}}}function Ve(t){let e,n,r;return{c(){e=p("button"),e.textContent="save",s(e,"class","text-xs p-1")},m(l,i){$(l,e,i),n||(r=ee(e,"click",t[8]),n=!0)},p:T,d(l){l&&y(e),n=!1,r()}}}function Fe(t){let e,n,r,l=t[1].tracks.total+"",i,a,u,f=Me(t[1].tracks.items),o=[];for(let d=0;d<f.length;d+=1)o[d]=We(Re(t,f,d));return{c(){e=p("div"),n=p("div"),r=p("div"),i=U(l),a=U(" tracks"),u=C();for(let d=0;d<o.length;d+=1)o[d].c();s(r,"class","bg-zinc-950 rounded-full text-white p-2"),s(n,"class","overflow-hidden overflow-x-scroll flex flex-row items-center space-x-2 p-1 relative"),s(e,"class","col-span-4 bg-zinc-500/10 rounded-md mx-2 text-xs flex flex-row justify-center")},m(d,g){$(d,e,g),c(e,n),c(n,r),c(r,i),c(r,a),c(n,u);for(let h=0;h<o.length;h+=1)o[h]&&o[h].m(n,null)},p(d,g){if(g&2&&l!==(l=d[1].tracks.total+"")&&te(i,l),g&10){f=Me(d[1].tracks.items);let h;for(h=0;h<f.length;h+=1){const w=Re(d,f,h);o[h]?o[h].p(w,g):(o[h]=We(w),o[h].c(),o[h].m(n,null))}for(;h<o.length;h+=1)o[h].d(1);o.length=f.length}},d(d){d&&y(e),tt(o,d)}}}function Kt(t){let e;return{c(){e=p("div"),e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-[5vh] h-[5vh]"><path stroke-linecap="round" stroke-linejoin="round" d="M18.364 18.364A9 9 0 0 0 5.636 5.636m12.728 12.728A9 9 0 0 1 5.636 5.636m12.728 12.728L5.636 5.636"></path></svg> ',s(e,"class","ring-1 ring-black shadow-md shadow-black rounded-full")},m(n,r){$(n,e,r)},p:T,d(n){n&&y(e)}}}function Gt(t){let e,n,r;return{c(){e=p("img"),s(e,"loading","lazy"),pe(e.src,n=t[0].track.album.images[0].url)||s(e,"src",n),s(e,"class",r="aspect-square h-[5vh] rounded-full ring-1 ring-black shadow-sm shadow-black will-change-auto "+(t[3].is?(t[3].statuses[t[0].track.id]=="downloading"?" rotating-image":"")+(t[3].statuses[t[0].track.id]=="ready"?" shadow-green-500 ring-green-500":"")+(t[3].statuses[t[0].track.id]=="failed"?" shadow-red-500 ring-red-500":""):"")),s(e,"alt","album")},m(l,i){$(l,e,i)},p(l,i){i&2&&!pe(e.src,n=l[0].track.album.images[0].url)&&s(e,"src",n),i&10&&r!==(r="aspect-square h-[5vh] rounded-full ring-1 ring-black shadow-sm shadow-black will-change-auto "+(l[3].is?(l[3].statuses[l[0].track.id]=="downloading"?" rotating-image":"")+(l[3].statuses[l[0].track.id]=="ready"?" shadow-green-500 ring-green-500":"")+(l[3].statuses[l[0].track.id]=="failed"?" shadow-red-500 ring-red-500":""):""))&&s(e,"class",r)},d(l){l&&y(e)}}}function We(t){let e;function n(i,a){return i[0].track&&i[0].track.album.images.length>0?Gt:Kt}let r=n(t),l=r(t);return{c(){l.c(),e=nt()},m(i,a){l.m(i,a),$(i,e,a)},p(i,a){r===(r=n(i))&&l?l.p(i,a):(l.d(1),l=r(i),l&&(l.c(),l.m(e.parentNode,e)))},d(i){i&&y(e),l.d(i)}}}function Jt(t){let e,n,r,l,i,a,u,f,o,d=t[0].name+"",g,h,w,m,x,E,L,S=t[0].description+"",A,P,O,z,H,_,B,G,oe,K=t[4]&&Object.keys(t[1]).length>0,I,N;function Y(k,D){return k[0].images.length>0?Dt:qt}let ne=Y(t),R=ne(t);function F(k,D){return k[4]?Nt:Ht}let W=F(t),j=W(t);function xe(k,D){return k[3].is?Ft:k[2].length>0?Vt:Rt}let b=xe(t),M=b(t),v=t[2].length>0&&!t[3].is&&Ve(t),q=K&&Fe(t);return{c(){e=p("div"),n=p("div"),l=C(),i=p("div"),a=p("div"),R.c(),u=C(),f=p("div"),o=p("a"),g=U(d),h=C(),w=V("svg"),m=V("path"),E=C(),L=p("p"),A=U(S),P=C(),O=p("div"),z=p("button"),j.c(),H=C(),_=p("button"),M.c(),G=C(),v&&v.c(),oe=C(),q&&q.c(),s(n,"class","h-1 absolute backdrop-opacity-50 bg-aodPurple rounded-sm left-0 bottom-0 z-50"),ge(n,"width",t[5]/100*90+"vw"),n.hidden=r=!t[3].is,s(a,"class","col-span-1 flex flex-col items-center justify-center"),s(m,"stroke-linecap","round"),s(m,"stroke-linejoin","round"),s(m,"d","M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"),s(w,"xmlns","http://www.w3.org/2000/svg"),s(w,"fill","none"),s(w,"viewBox","0 0 24 24"),s(w,"stroke-width","1.5"),s(w,"stroke","currentColor"),s(w,"class","w-4 h-4 inline"),s(o,"class","hover:scale-110 duration-75 text-left line-clamp-1"),s(o,"href",x=t[0].external_urls.spotify),s(o,"target","_blank"),s(L,"class","text-xs line-clamp-1"),s(z,"class","bg-transparent text-white ring-1 p-1 ring-zinc-500 hover:scale-110"),s(z,"aria-label","show more"),s(_,"class","text-xs bg-aodPurple p-1"),_.disabled=B=t[3].is||t[2].length>0,s(O,"class","flex flex-row space-x-2"),s(f,"class","col-span-3 flex flex-col justify-center items-start"),s(i,"class","grid grid-cols-4 w-full gap-1"),s(e,"class","bg-gray-950/50 ring-1 ring-zinc-500 py-2 rounded-md w-[90vw] text-center relative transition-all duration-150")},m(k,D){$(k,e,D),c(e,n),c(e,l),c(e,i),c(i,a),R.m(a,null),c(i,u),c(i,f),c(f,o),c(o,g),c(o,h),c(o,w),c(w,m),c(f,E),c(f,L),c(L,A),c(f,P),c(f,O),c(O,z),j.m(z,null),c(O,H),c(O,_),M.m(_,null),c(O,G),v&&v.m(O,null),c(i,oe),q&&q.m(i,null),I||(N=[ee(z,"click",t[7]),ee(_,"click",t[9])],I=!0)},p(k,[D]){D&32&&ge(n,"width",k[5]/100*90+"vw"),D&8&&r!==(r=!k[3].is)&&(n.hidden=r),ne===(ne=Y(k))&&R?R.p(k,D):(R.d(1),R=ne(k),R&&(R.c(),R.m(a,null))),D&1&&d!==(d=k[0].name+"")&&te(g,d),D&1&&x!==(x=k[0].external_urls.spotify)&&s(o,"href",x),D&1&&S!==(S=k[0].description+"")&&te(A,S),W!==(W=F(k))&&(j.d(1),j=W(k),j&&(j.c(),j.m(z,null))),b===(b=xe(k))&&M?M.p(k,D):(M.d(1),M=b(k),M&&(M.c(),M.m(_,null))),D&12&&B!==(B=k[3].is||k[2].length>0)&&(_.disabled=B),k[2].length>0&&!k[3].is?v?v.p(k,D):(v=Ve(k),v.c(),v.m(O,null)):v&&(v.d(1),v=null),D&18&&(K=k[4]&&Object.keys(k[1]).length>0),K?q?q.p(k,D):(q=Fe(k),q.c(),q.m(i,null)):q&&(q.d(1),q=null)},i:T,o:T,d(k){k&&y(e),R.d(),j.d(),M.d(),v&&v.d(),q&&q.d(),I=!1,se(N)}}}function Qt(t,e,n){let r,l={},i=[],{track:a}=e;const u={is:!1,statuses:{},stage:""};let f=!1,o=Tt(0,{duration:1e3,easing:Ut});Le(t,o,m=>n(5,r=m));const d=()=>{f==!1?(Object.keys(l).length==0&&g(),n(4,f=!0)):n(4,f=!1)},g=async()=>{const m=a.external_urls.spotify,E=new URL(m).pathname.split("/")[2];J("loading playlist info",!0,1);let L=await re.getPlaylistInfo(E);n(1,l=L)},h=()=>{i.forEach((m,x)=>{const E=URL.createObjectURL(m),L=document.createElement("a");L.href=E,L.download=`${a.name}-${x+1}.mp3`,L.click()})},w=async()=>{if(Object.keys(l).length==0&&await g(),!l.tracks)return;if(l.tracks.items.length==0){J("cannot download empty playlist");return}n(3,u.is=!0,u),n(3,u.stage="converting",u),o.set(0,{duration:1}),o.set(10,{duration:1e4});let m=l.tracks.items[0].track;re.getDownloadTrack(m.external_urls.spotify,"",!0).then(async x=>{if(x.success==!1){Q(o,r=0,r),n(3,u.is=!1,u),J(`serverErr: ${x.info}`);return}const E=x.data.key;n(3,u.statuses[m.id]="downloading",u);for(const[S,{track:A}]of[...l.tracks.items].splice(1).entries())A&&n(3,u.statuses[A.id]="downloading",u),(await re.getDownloadTrack(A.external_urls.spotify,E,!1)).success==!1&&J(`failed downloading track (${A.name})`);await o.set(10);const L=setInterval(async()=>{let S=await re.getDownloadStatus(E);const A=S.data.filter(P=>P.status!=="downloading");if(S.data.forEach(P=>{n(3,u.statuses[P.id]=P.status,u)}),Q(o,r=A.length/S.data.length*40+10,r),A.length==S.data.length){n(3,u.stage="downloading",u),clearInterval(L);for(let P=0;P<A.length;P++){let[O,z]=await re.getStreamPlaylist(E);if(!O){J(`failed downloading a track (in "${a.name}")`);continue}n(2,i=[...i,z]),Q(o,r=(P+1)/A.length*50+50,r)}await o.set(100,{duration:500}),n(3,u.is=!1,u)}},5e3)})};return t.$$set=m=>{"track"in m&&n(0,a=m.track)},[a,l,i,u,f,r,o,d,h,w]}class Xt extends _e{constructor(e){super(),we(this,e,Qt,Jt,ie,{track:0})}}const ve=Be({loggedIn:!1,user:{},playlists:{}});function Ze(t,e,n){const r=t.slice();return r[2]=e[n],r}function Yt(t){let e,n;return{c(){e=V("svg"),n=V("path"),s(n,"stroke-linecap","round"),s(n,"stroke-linejoin","round"),s(n,"d","M18.364 18.364A9 9 0 0 0 5.636 5.636m12.728 12.728A9 9 0 0 1 5.636 5.636m12.728 12.728L5.636 5.636"),s(e,"xmlns","http://www.w3.org/2000/svg"),s(e,"fill","none"),s(e,"viewBox","0 0 24 24"),s(e,"stroke-width","1.5"),s(e,"stroke","currentColor"),s(e,"class","w-[10vh] h-[10vh] rounded-full ring-aodBg ring-2")},m(r,l){$(r,e,l),c(e,n)},p:T,d(r){r&&y(e)}}}function en(t){let e,n,r;return{c(){e=p("img"),s(e,"loading","lazy"),pe(e.src,n=t[0].user.images[1].url)||s(e,"src",n),s(e,"alt",r=`${t[0].user.display_name}'s profile picture`),s(e,"class","rounded-full h-[10vh] ring-aodBg ring-1 shadow-sm shadow-black")},m(l,i){$(l,e,i)},p(l,i){i&1&&!pe(e.src,n=l[0].user.images[1].url)&&s(e,"src",n),i&1&&r!==(r=`${l[0].user.display_name}'s profile picture`)&&s(e,"alt",r)},d(l){l&&y(e)}}}function Ke(t){let e,n;return e=new Xt({props:{track:t[2]}}),{c(){ye(e.$$.fragment)},m(r,l){he(e,r,l),n=!0},p(r,l){const i={};l&1&&(i.track=r[2]),e.$set(i)},i(r){n||(Z(e.$$.fragment,r),n=!0)},o(r){X(e.$$.fragment,r),n=!1},d(r){me(e,r)}}}function tn(t){let e,n,r,l,i,a,u=t[0].user.display_name+"",f,o,d,g=t[0].user.followers.total+"",h,w,m=t[0].playlists.total+"",x,E,L,S,A=t[0].user.id+"",P,O,z,H,_,B,G,oe,K,I,N,Y;function ne(b,M){return b[0].user.images.length==2?en:Yt}let R=ne(t),F=R(t),W=Me(t[0].playlists.items),j=[];for(let b=0;b<W.length;b+=1)j[b]=Ke(Ze(t,W,b));const xe=b=>X(j[b],1,1,()=>{j[b]=null});return{c(){e=p("div"),n=p("div"),r=p("div"),F.c(),l=C(),i=p("div"),a=p("p"),f=U(u),o=C(),d=p("p"),h=U(g),w=U(" followers, "),x=U(m),E=U(" playlists"),L=C(),S=p("p"),P=U(A),O=C(),z=p("div"),H=p("button"),H.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-[1.5em] inline"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 9V5.25A2.25 2.25 0 0 1 10.5 3h6a2.25 2.25 0 0 1 2.25 2.25v13.5A2.25 2.25 0 0 1 16.5 21h-6a2.25 2.25 0 0 1-2.25-2.25V15m-3 0-3-3m0 0 3-3m-3 3H15"></path></svg>logout',_=C(),B=p("div"),G=p("div");for(let b=0;b<j.length;b+=1)j[b].c();oe=C(),K=p("div"),s(a,"class","font-semibold"),ge(a,"text-shadow","4px 3px 8px rgba(0,0,0,1)"),s(d,"class","text-xs"),s(S,"class","text-xs"),s(i,"class","flex flex-col justify-center items-start"),s(r,"class","flex flex-row items-center justify-center space-x-5"),s(H,"class","text-sm p-0.5 bg-red-500 text-gray-950"),s(H,"aria-label","logout"),s(n,"class","flex flex-row justify-center items-center h-[13vh] space-x-4 bg-gradient-to-t from-gray-950/50 backdrop-blur-sm to-zinc-500 w-[90vw] rounded-t-md ring-1 ring-zinc-500 z-50"),s(G,"class","flex flex-col justify-center items-center w-full space-y-2 pb-1"),s(B,"class","h-[67vh] overflow-y-scroll w-[100vw]"),s(K,"class","backdrop-opacity-100 rounded-full backdrop-blur-sm w-[95vw] h-7 absolute bottom-0 left-auto right-auto"),s(e,"class","flex flex-col items-center -space-y-1")},m(b,M){$(b,e,M),c(e,n),c(n,r),F.m(r,null),c(r,l),c(r,i),c(i,a),c(a,f),c(i,o),c(i,d),c(d,h),c(d,w),c(d,x),c(d,E),c(i,L),c(i,S),c(S,P),c(n,O),c(n,z),c(z,H),c(e,_),c(e,B),c(B,G);for(let v=0;v<j.length;v+=1)j[v]&&j[v].m(G,null);c(e,oe),c(e,K),I=!0,N||(Y=ee(H,"click",t[1]),N=!0)},p(b,[M]){if(R===(R=ne(b))&&F?F.p(b,M):(F.d(1),F=R(b),F&&(F.c(),F.m(r,l))),(!I||M&1)&&u!==(u=b[0].user.display_name+"")&&te(f,u),(!I||M&1)&&g!==(g=b[0].user.followers.total+"")&&te(h,g),(!I||M&1)&&m!==(m=b[0].playlists.total+"")&&te(x,m),(!I||M&1)&&A!==(A=b[0].user.id+"")&&te(P,A),M&1){W=Me(b[0].playlists.items);let v;for(v=0;v<W.length;v+=1){const q=Ze(b,W,v);j[v]?(j[v].p(q,M),Z(j[v],1)):(j[v]=Ke(q),j[v].c(),Z(j[v],1),j[v].m(G,null))}for(st(),v=W.length;v<j.length;v+=1)xe(v);it()}},i(b){if(!I){for(let M=0;M<W.length;M+=1)Z(j[M]);I=!0}},o(b){j=j.filter(Boolean);for(let M=0;M<j.length;M+=1)X(j[M]);I=!1},d(b){b&&y(e),F.d(),tt(j,b),N=!1,Y()}}}function nn(t,e,n){let r;return Le(t,ve,i=>n(0,r=i)),[r,()=>{localStorage.removeItem("cartier-userid"),Q(ve,r.loggedIn=!1,r)}]}class rn extends _e{constructor(e){super(),we(this,e,nn,tn,ie,{})}}function ln(t){let e,n;return e=new rn({}),{c(){ye(e.$$.fragment)},m(r,l){he(e,r,l),n=!0},p:T,i(r){n||(Z(e.$$.fragment,r),n=!0)},o(r){X(e.$$.fragment,r),n=!1},d(r){me(e,r)}}}function sn(t){let e,n;return e=new Bt({props:{handleUsername:t[1]}}),{c(){ye(e.$$.fragment)},m(r,l){he(e,r,l),n=!0},p:T,i(r){n||(Z(e.$$.fragment,r),n=!0)},o(r){X(e.$$.fragment,r),n=!1},d(r){me(e,r)}}}function on(t){let e;return{c(){e=p("span"),e.textContent="PROD",s(e,"class","rounded-sm p-0.5 bg-blue-600")},m(n,r){$(n,e,r)},d(n){n&&y(e)}}}function an(t){let e,n,r,l,i,a,u,f,o,d,g,h,w,m,x,E,L,S,A,P,O,z;const H=[sn,ln],_=[];function B(I,N){return I[0].loggedIn==!1?0:1}o=B(t),d=_[o]=H[o](t);function G(I,N){return on}let K=G()(t);return{c(){e=p("div"),n=C(),r=p("main"),l=p("div"),l.innerHTML='<div class="bg-aodPurple shadow-sm text-gray-950 shadow-gray-950 rounded-b-md p-2 ml-2 h-full flex flex-col items-center justify-center"><span>reold&#39;s</span></div> <p class="text-3xl">Cartier Manager</p>',i=C(),a=p("div"),u=p("div"),f=C(),d.c(),g=C(),h=p("div"),w=p("p"),K.c(),m=U(`
      Built with ❤️ by
      `),x=p("a"),x.textContent="reold",E=U(`.
      `),L=p("button"),L.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-[1em] inline"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 17.25v-.228a4.5 4.5 0 0 0-.12-1.03l-2.268-9.64a3.375 3.375 0 0 0-3.285-2.602H7.923a3.375 3.375 0 0 0-3.285 2.602l-2.268 9.64a4.5 4.5 0 0 0-.12 1.03v.228m19.5 0a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3m19.5 0a3 3 0 0 0-3-3H5.25a3 3 0 0 0-3 3m16.5 0h.008v.008h-.008v-.008Zm-3 0h.008v.008h-.008v-.008Z"></path></svg>
        use Render.`,S=C(),A=p("a"),A.textContent="Report an error",s(e,"class","bg-black opacity-75 p-1 rounded-md w-[80vw] max-w-[90vw] z-50"),ge(e,"display","none"),s(l,"class","flex flex-row items-center justify-evenly font-bold h-[10vh] pb-2 bg-gray-950 ring-1 ring-zinc-500 shadow-xl"),s(u,"class","absolute left-0 top-0 w-full flex flex-col items-center justify-center space-y-1 text-xs"),s(a,"class","relative w-full flex flex-col items-center justify-center h-[85vh] bg-gradient-to-t from-gray-950 via-[#203A43] to-gray-950"),s(x,"href","https://github.com/reold"),s(x,"target","_blank"),s(x,"class","text-blue-600"),s(L,"aria-label","use alternative render service servers"),s(L,"class","p-0 bg-transparent text-orange-600 text-xs"),s(A,"href","https://x.com/redicrafty"),s(A,"target","_blank"),s(A,"class","text-blue-600"),s(h,"class","w-full h-[5vh] bg-gray-950 text-sm flex flex-col items-center justify-center"),s(r,"class","w-screen h-screen text-white text-xl select-none text-center")},m(I,N){$(I,e,N),t[2](e),$(I,n,N),$(I,r,N),c(r,l),c(r,i),c(r,a),c(a,u),t[3](u),c(a,f),_[o].m(a,null),c(r,g),c(r,h),c(h,w),K.m(w,null),c(w,m),c(w,x),c(w,E),c(w,L),c(w,S),c(w,A),P=!0,O||(z=ee(L,"click",t[4]),O=!0)},p(I,[N]){let Y=o;o=B(I),o===Y?_[o].p(I,N):(st(),X(_[Y],1,1,()=>{_[Y]=null}),it(),d=_[o],d?d.p(I,N):(d=_[o]=H[o](I),d.c()),Z(d,1),d.m(a,null))},i(I){P||(Z(d),P=!0)},o(I){X(d),P=!1},d(I){I&&(y(e),y(n),y(r)),t[2](null),t[3](null),_[o].d(),K.d(),O=!1,z()}}}let ze,ot;const J=(t,e=!1,n=3)=>{const r=ot.cloneNode(!0);r.innerHTML=e?`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-[1.2em] animate-spin inline aspect-square mr-1" > <path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99" /> </svg>${t}`:t,r.style.display="block",ze.appendChild(r),setTimeout(()=>{ze.removeChild(r)},n*1e3)};function cn(t,e,n){let r;Le(t,ve,f=>n(0,r=f));const l=f=>{re.getUserInfo(f).then(o=>{if(o.success==!1){J("something went wrong!");return}Q(ve,r={...r,...o.data},r),Q(ve,r.loggedIn=!0,r)})};function i(f){Ce[f?"unshift":"push"](()=>{ot=f})}function a(f){Ce[f?"unshift":"push"](()=>{ze=f})}return[r,l,i,a,()=>{window["cartier-server-url"]="https://cartier-backend.onrender.com",J("switched to alternate (render) server")}]}class un extends _e{constructor(e){super(),we(this,e,cn,an,ie,{})}}new un({target:document.getElementById("app")});
